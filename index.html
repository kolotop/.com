<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>KOLO ‚Äî –±–∞—Ä–∞—Ö–æ–ª–∫–∞ –æ–≥–æ–ª–æ—à–µ–Ω—å</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no"/>
  <meta name="format-detection" content="telephone=no"/>
  <meta name="theme-color" content="#10b981"/>

  <!-- Share preview -->
  <meta property="og:title" content="KOLO ‚Äî –±–∞—Ä–∞—Ö–æ–ª–∫–∞ –æ–≥–æ–ª–æ—à–µ–Ω—å">
  <meta property="og:description" content="KOLO: –¥–æ–¥–∞–π –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –∑–∞ —Ö–≤–∏–ª–∏–Ω—É. HOT, –≥–∞–ª–µ—Ä–µ—è, –ª–∞–π–∫–∏ —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–¥–∏.">
  <meta property="og:image" content="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='630'><rect width='100%' height='100%' fill='%2310b981'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Arial Black,Arial' font-size='96' fill='white'>KOLO</text></svg>">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect rx='14' ry='14' width='64' height='64' fill='%2310b981'/><circle cx='32' cy='32' r='14' fill='white'/></svg>">

  <link href="https://fonts.googleapis.com/css2?family=Russo+One&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6fbf8;
      --paper:#ffffff; --ink:#0f172a;
      --muted:#64748b;
      --brand:#0ea371; --brand-press:#0c8f63;
      --line:#d6e8de;
      --field-bg:#edf7f1; --field-br:#cfe8da;
      --ph:#7aa896;
      --menu-bg:#ffffff; --menu-br:#cfe8da; --menu-hover:#eefaf3;
      --top:60px;

      /* HOT ‚Äî —á–∏—Å—Ç–æ –∫—Ä–∞—Å–Ω—ã–π, –±–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
      --hotSolid:#e60023;

      --thumb-ph:#e7f4ee;
      --shadow-sm: 0 4px 12px rgba(2, 44, 34, .08);
      --shadow-lg: 0 14px 40px rgba(2, 44, 34, .14);
    }
    html{-webkit-text-size-adjust:100%}
    *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--ink); font-family:"Montserrat",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;}
    body.modal-open{overflow:hidden}

    /* ====== LOADER (5s) ====== */
    #boot{
      position:fixed; inset:0; background:#ffffff; z-index:1000; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:12px;
    }
    #boot .logo{
      font:900 40px/1 "Russo One"; color:#10b981; letter-spacing:1px;
    }
    #boot .ring{
      width:120px; height:120px; border-radius:50%;
      border:6px solid #e8f5ef; border-top-color:#10b981;
      animation:spin 1.2s linear infinite;
    }
    #boot .tagline{font-size:13px; opacity:.8; color:#0f172a}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:100;
      height:var(--top); display:flex; align-items:center; gap:10px;
      padding:10px 12px; background:#ffffffcc; backdrop-filter:saturate(140%) blur(6px);
      border-bottom:1px solid var(--line);
    }
    .logo{background:var(--brand); color:#fff; border-radius:12px; padding:8px 12px; font:700 16px/1 "Russo One",sans-serif; box-shadow:var(--shadow-sm)}
    .pill{display:inline-flex; align-items:center; gap:8px; height:38px; padding:0 12px; border-radius:12px; border:1px solid var(--line); background:#fff; cursor:pointer; font-weight:700; color:var(--ink); user-select:none}
    .pill.green{background:var(--brand); color:#fff; border-color:transparent; font-family:"Russo One"; text-transform:uppercase; box-shadow:var(--shadow-sm); text-shadow:0 1px 0 rgba(0,0,0,.35)}
    .pill.green:active{transform:none} /* –±–µ–∑ —Å–¥–≤–∏–≥–∞ */
    .grow{flex:1}
    .visitors{display:inline-flex; align-items:center; gap:8px; height:38px; padding:0 12px; border-radius:12px; border:1px solid var(--line); background:#fff; font-weight:800; color:#0b3b2d; user-select:none}

    .container{max-width:1200px; margin:12px auto; padding:0 12px 120px;} /* –Ω–∏–∂–Ω–∏–π –ø–∞–¥–¥–∏–Ω–≥, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø—Ä–∏–ª–∏–ø–∞–ª–∞ */
    .panel{background:var(--paper); border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-sm);}

    /* ===== –†–ï–ö–õ–ê–ú–ù–ò–ô –ë–õ–û–ö ===== */
    .adWrap{margin:8px 0 6px}
    .adBar{
      position:relative; height:84px; border:1px solid var(--line); border-radius:12px;
      background:#fff; display:flex; align-items:center; justify-content:center; overflow:hidden;
    }
    .adBar img{height:100%; width:auto; object-fit:cover}
    .adNote{font-size:12px; opacity:.85; text-align:right; margin-top:6px; padding:0 4px}

    /* HOT strip */
    .hotWrap{margin:10px 0 6px}
    .hotHead{display:flex; align-items:center; gap:12px; margin-bottom:8px; color:#0e3a2a}
    .hotHead .tag{background:var(--hotSolid); padding:8px 12px; border-radius:12px; font:700 14px/1 "Russo One"; color:#fff; box-shadow:0 0 0 1px #b40019 inset}
    .hotGrid{display:grid; grid-template-columns:repeat(5,1fr); gap:10px}
    @media (max-width:1024px){ .hotGrid{grid-template-columns:repeat(3,1fr);} }
    @media (max-width:640px){ .hotGrid{grid-template-columns:repeat(2,1fr);} }
    .hotCard{border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff; cursor:pointer; box-shadow:var(--shadow-sm)}
    .hotCard .thumb{position:relative; padding-top:56%; background:var(--thumb-ph); overflow:hidden;}
    .hotBadge{position:absolute; left:8px; top:8px; background:var(--hotSolid); padding:4px 8px; border-radius:10px; font:800 12px/1 "Russo One"; color:#fff; border:1px solid #b40019; z-index:2}
    .hotPrice{position:absolute; right:8px; bottom:8px; background:var(--brand); color:#fff; border:0; padding:6px 8px; border-radius:10px; font-weight:800; font-size:12px; z-index:2}
    .hotBody{padding:8px; font-size:13px}
    .hotTTL{font:700 14px/1.2 "Russo One"; color:#0f172a}
    .hotSplit{height:1px; background:var(--line); margin:14px 0 6px; border-radius:1px}

    /* Grid */
    .topline{display:flex; align-items:center; gap:10px; margin:14px 0;}
    .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:12px;}
    @media (max-width:1024px){ .grid{grid-template-columns:repeat(2,1fr);} }
    @media (max-width:640px){ .grid{grid-template-columns:1fr;} }

    .card{ background:#fff; border:1px solid var(--line); border-radius:14px; overflow:hidden; display:flex; flex-direction:column; cursor:pointer; transition:box-shadow .08s ease; box-shadow:var(--shadow-sm)}
    .card:active{box-shadow:var(--shadow-lg)}
    .thumb{position:relative; padding-top:62%; background:var(--thumb-ph); overflow:hidden;}
    .thumb img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover;}
    .badge{position:absolute; right:8px; bottom:8px; background:var(--brand); color:#fff; border-radius:10px; padding:5px 8px; font:800 12px/1 "Russo One"; z-index:2}
    /* like + views –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∞ –≤—Å—ñ—Ö –¥–µ–≤–∞–π—Å–∞—Ö */
    .pillIcon{display:inline-flex; align-items:center; gap:6px}
    .likeBtn,.viewPill,.shareBtn{
      position:absolute; top:8px; height:32px; min-width:58px;
      padding:0 8px; display:flex; align-items:center; justify-content:center; gap:6px;
      border-radius:10px; border:0; background:var(--brand); color:#fff;
      font:900 14px/32px 'Russo One',sans-serif; box-shadow:var(--shadow-sm); outline:none; z-index:2
    }
    .likeBtn{right:8px; cursor:pointer}
    .viewPill{left:8px}
    .shareBtn{right:76px; min-width:40px; padding:0 8px} /* –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ ‚Äî –ø–æ –∂–µ–ª–∞–Ω–∏—é */

    .body{padding:10px; display:flex; flex-direction:column; gap:6px}
    .title{font:700 16px/1.2 "Russo One"; letter-spacing:.4px; color:#0f172a}

    /* Detail modal */
    .detail{position:fixed; inset:0; z-index:120; display:none; background:rgba(0,0,0,.35);}
    .detail.active{display:block;}
    .sheet{position:absolute; left:50%; top:6vh; transform:translateX(-50%); width:min(1080px,96vw); max-height:88vh; overflow:auto; background:#fff; border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-lg);}
    .modalHead{display:flex; align-items:center; gap:10px; margin-bottom:8px}

    /* Gallery */
    .big{position:relative; padding-top:56%; background:var(--thumb-ph); border-radius:12px; overflow:hidden}
    .big img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    .navBtn{
      position:absolute; top:50%; transform:translateY(-50%);
      height:48px; min-width:48px; padding:0 12px;
      border-radius:14px; border:1px solid var(--line);
      background:#ffffffdd;
      color:#065f46; font-weight:900; font-size:26px; line-height:46px;
      cursor:pointer; box-shadow:var(--shadow-sm);
      backdrop-filter:saturate(110%) blur(3px);
    }
    .navPrev{left:8px} .navNext{right:8px}

    .specs{display:grid; grid-template-columns:repeat(4,1fr); gap:8px}
    @media (max-width:900px){ .specs{grid-template-columns:repeat(2,1fr);} }
    .spec{background:#f4fbf7; border:1px solid var(--line); border-radius:12px; padding:8px; font-size:13px}
    .h{font:700 14px/1 "Russo One"; margin-bottom:6px; color:#0b3b2d}
    .divider{height:1px; background:var(--line); margin:10px 0}
    .seller{display:flex; gap:10px; align-items:center}
    .avatar{width:44px; height:44px; border-radius:50%; background:#dff3ea; color:#065f46; display:flex; align-items:center; justify-content:center; font-weight:800}

    .pager{display:flex; justify-content:center; margin:16px 0 60px}
    #dAttribution{display:none}

    /* SELL / SEARCH modal */
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:150}
    .overlay.on{display:flex}
    .modal{width:min(960px,96vw); max-height:88vh; overflow:auto; background:#fff; border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-lg);}
    .closeX{height:38px; border:1px solid var(--line); background:#fff; color:#0f172a; border-radius:12px; font:700 13px/38px 'Russo One'; padding:0 12px; cursor:pointer}

    label{font-size:12px; font-weight:800; opacity:.92; display:block; margin:0 0 6px; color:#0b3b2d}
    .input,.select{ width:100%; height:46px; border-radius:12px; border:1px solid var(--field-br); background:var(--field-bg); color:#064e3b; padding:0 12px; font-size:14px; outline:none; }
    .input::placeholder{color:var(--ph)}
    textarea.input{color:#0f172a}
    .actions{display:flex; gap:10px; margin-top:10px; flex-wrap:wrap}
    .btn{height:44px; border:none; border-radius:14px; background:var(--brand); color:#fff; font:700 15px/44px "Russo One"; padding:0 18px; cursor:pointer; box-shadow:var(--shadow-sm); text-shadow:0 1px 0 rgba(0,0,0,.35)}
    .btn:active{transform:none} /* –±–µ–∑ —Å–¥–≤–∏–≥–∞ */
    .btn.ghost{background:#fff; color:#0f172a; border:1px solid var(--line); box-shadow:none; text-shadow:none}

    /* Choice overlay */
    .choiceGrid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width:640px){ .choiceGrid{grid-template-columns:1fr} }
    .choiceCard{border:1px solid var(--line); border-radius:14px; padding:16px; cursor:pointer}
    .choiceCard:hover{box-shadow:var(--shadow-sm)}
    .choiceCard.normal{background:var(--brand); color:#fff; border-color:transparent; box-shadow:var(--shadow-sm)}
    .choiceCard.hot{background:var(--hotSolid); color:#fff; border-color:#b40019}

    /* nice select minimal */
    .nice-hidden{display:none}
    .nice-btn{height:46px; width:100%; border-radius:12px; border:1px solid var(--field-br); background:var(--field-bg); color:#064e3b; padding:0 12px; text-align:left; font-weight:700}
    .nice-list{position:absolute; display:none; background:#fff; border:1px solid var(--line); border-radius:12px; box-shadow:var(--shadow-lg); max-height:260px; overflow:auto; z-index:9999}
    .nice-item{padding:10px 12px; cursor:pointer}
    .nice-item:hover{background:#f3faf5}
    .nice-item.active{background:#e8f6ef; font-weight:800}
  </style>
</head>
<body>
  <!-- LOADER -->
  <div id="boot" aria-hidden="false">
    <div class="logo">KOLO</div>
    <div class="ring" aria-label="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"></div>
    <div class="tagline">–î–æ—à–∫–∞ –æ–≥–æ–ª–æ—à–µ–Ω—å ‚Ññ1 –≤ –£–∫—Ä–∞—ó–Ω—ñ</div>
  </div>

  <header class="topbar">
    <div class="logo">KOLO</div>
    <div class="pill" id="tabSearch">–ü–æ—à—É–∫</div>
    <div class="visitors" id="visitors">
      <span class="pillIcon" id="visIcon"></span>
      <span>–∫–æ—Ä–∏—Å—É–≤–∞—á—ñ–≤</span>
      <strong id="visNum">0</strong>
    </div>
    <div class="grow"></div>
    <div class="pill green" id="tabSell">–î–æ–¥–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</div>
  </header>

  <main class="container">
    <!-- –†–ï–ö–õ–ê–ú–ê (—Å—Ç–∞—Ç–∏—á–Ω–∏–π –±–ª–æ–∫; –∫–∞—Ä—Ç–∏–Ω–∫—É –ø—ñ–¥—Å—Ç–∞–≤–∏—Ç–µ —ñ–∑ —Å–µ—Ä–≤–µ—Ä–∞) -->
    <div class="adWrap">
      <div class="adBar">
        <img id="adImg" alt="ad">
      </div>
      <div class="adNote">–ó–∞–º–æ–≤–∏—Ç–∏ —Ä–µ–∫–ª–∞–º—É</div>
    </div>

    <!-- HOT -->
    <section class="panel hotWrap" id="hotPanel" style="display:none">
      <div class="hotHead"><div class="tag">üî• HOT</div></div>
      <div class="hotGrid" id="hotGrid"></div>
    </section>
    <div class="hotSplit" id="hotSplit" style="display:none"></div>

    <!-- RESULTS -->
    <section class="topline"><div class="grow"></div></section>
    <section class="grid" id="grid"></section>
    <div class="pager"><button class="btn" id="btnMore" style="display:none">–ü–æ–∫–∞–∑–∞—Ç–∏ —â–µ</button></div>
  </main>

  <!-- DETAIL -->
  <div id="detail" class="detail" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="modalHead">
        <div class="logo">KOLO</div>
        <div class="grow"></div>
        <button title="–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è" aria-label="–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è" class="pill" id="dShare" style="height:34px;line-height:34px;padding:0 12px;gap:8px">
          <span class="pillIcon" id="dShareIcon"></span>–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è
        </button>
        <button title="–õ–∞–π–∫" aria-label="–õ–∞–π–∫" class="pill green" id="dLike" style="height:34px;line-height:34px;padding:0 12px;gap:8px">
          <span class="pillIcon" id="dLikeIcon"></span><span id="dLikeCnt">0</span>
        </button>
        <button class="closeX" id="dClose">–ó–∞–∫—Ä–∏—Ç–∏</button>
      </div>
      <div id="dHeader" style="display:flex; align-items:center; gap:10px; margin-bottom:8px"></div>
      <div id="dGal"></div>
      <div class="divider"></div>
      <div class="specs" id="dSpecs"></div>
      <div class="divider"></div>
      <div id="dDesc" style="opacity:.9"></div>
      <div class="divider"></div>
      <div class="seller" id="dSeller"></div>
      <div id="dAttribution" style="margin-top:8px; font-size:12px; opacity:.8"></div>
    </div>
  </div>

  <!-- SELL TYPE CHOICE -->
  <div class="overlay" id="sellChoiceOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="choiceTitle">
      <div class="modalHead">
        <h3 id="choiceTitle" style="margin:0; font:700 18px/1 'Russo One'; color:#0f172a">–û–±—Ä–∞—Ç–∏ —Ç–∏–ø –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</h3>
        <div class="grow"></div>
        <button class="closeX" id="choiceClose">–ó–∞–∫—Ä–∏—Ç–∏</button>
      </div>
      <div class="choiceGrid">
        <div class="choiceCard normal" id="chooseNormal">
          <div class="title" style="font:700 18px/1 'Russo One'; color:#fff">–ó–≤–∏—á–∞–π–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</div>
          <div style="opacity:.95;margin-top:6px;color:#fff">–ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º</div>
        </div>
        <div class="choiceCard hot" id="chooseHot">
          <div class="title" style="font:700 18px/1 'Russo One'; color:#fff">HOT —à–≤–∏–¥–∫–∏–π –ø—Ä–æ–¥–∞–∂</div>
          <div style="opacity:.95;margin-top:6px;color:#fff">–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –≤–∏–¥–∏–º—ñ—Å—Ç—å —É —Å–ø–∏—Å–∫–∞—Ö</div>
        </div>
      </div>
    </div>
  </div>

  <!-- SELL MODAL -->
  <div class="overlay" id="sellOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="sellTitle">
      <div class="modalHead">
        <h3 id="sellTitle" style="margin:0; font:700 18px/1 'Russo One'; color:#0f172a">–î–æ–¥–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</h3>
        <div class="grow"></div>
        <button class="closeX" id="sellClose">–ó–∞–∫—Ä–∏—Ç–∏</button>
      </div>
      <div class="actions" style="margin:-4px 0 8px"><span id="sellModeBadge" class="pill green">–ó–≤–∏—á–∞–π–Ω–µ</span></div>
      <div class="filters" style="display:grid; grid-template-columns:repeat(3,1fr); gap:10px;">
        <div><label>–û–±–ª–∞—Å—Ç—å</label><input class="input" id="sRegion"></div>
        <div><label>–ú—ñ—Å—Ç–æ</label><input class="input" id="sCity"></div>
        <div><label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label><select class="select" id="sCat"></select></div>

        <div style="grid-column:1/-1"><label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label><input class="input" id="sTitle"></div>

        <div><label>–°—Ç–∞–Ω</label><select class="select" id="sCond"></select></div>
        <div><label>–¶—ñ–Ω–∞, ‚Ç¥</label><input class="input" id="sPrice" inputmode="numeric"></div>
        <div><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input class="input" id="sPhone" placeholder="+380 (..) ...-..-.."></div>

        <div style="grid-column:1/-1"><label>–û–ø–∏—Å</label><textarea class="input" id="sDesc" rows="3" style="height:auto; padding:10px"></textarea></div>
        <div style="grid-column:1/-1"><label>–§–æ—Ç–æ</label><input class="input" id="sImages" type="file" accept="image/*" multiple></div>
      </div>
      <div class="actions"><button class="btn" id="sSave">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button></div>
    </div>
  </div>

  <!-- SEARCH -->
  <div class="overlay" id="searchOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="searchTitle">
      <div class="modalHead">
        <h3 id="searchTitle" style="margin:0; font:700 18px/1 'Russo One'; color:#0f172a">–ü–æ—à—É–∫</h3>
        <div class="grow"></div>
        <button class="closeX" id="searchClose">–ó–∞–∫—Ä–∏—Ç–∏</button>
      </div>
      <div style="display:grid; grid-template-columns:1fr; gap:10px;">
        <div><label>–ö–ª—é—á–æ–≤–µ —Å–ª–æ–≤–æ</label><input class="input" id="fltQuery" placeholder="–ù–∞–ø—Ä., iPhone, –¥–∏–≤–∞–Ω, –≤–µ–ª–æ—Å–∏–ø–µ–¥"></div>
        <div style="display:flex; gap:10px">
          <button class="btn" id="btnApply">–ó–Ω–∞–π—Ç–∏</button>
          <button class="btn ghost" id="btnReset">–°–∫–∏–Ω—É—Ç–∏</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);

  /* === –í–µ—Ä—Å–∏–∏ –∏ –∫–ª—é—á–∏ === */
  const DB_KEY = "kolo_listings_v3";
  const CTRL_KEY = "kolo_ctrl_v3";
  const VER_KEY = "kolo_ver_v3";
  const ADS_KEY = "kolo_ads_v1";

  /* === –í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ (–æ–¥–Ω–∞–∫–æ–≤–æ —É –≤—Å—ñ—Ö) === */
  const VIS_BASE = 17369;
  const START_TS = Date.UTC(2025,0,1,0,0,0);    // –∑–∞–≥–∞–ª—å–Ω–∏–π –µ–ø–æ—Ö–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ä—Ç
  const BUCKET_MS = 15000;                      // –∫—Ä–æ–∫ 15 —Å
  function hash32(n){ n|=0; n = (n^0x9e3779b9)>>>0; n = Math.imul(n^ (n>>>16), 2246822507)>>>0; n = Math.imul(n^ (n>>>13), 3266489909)>>>0; return (n^ (n>>>16))>>>0; }
  function bucketInc(i){ return 1 + (hash32(i)%3); } // –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–∏–π +1..+3
  function visitorsNow(){
    const now = Date.now();
    const buckets = Math.floor((now - START_TS)/BUCKET_MS);
    let sum = 0;
    // –ß—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ç—è–∂—ë–ª–æ–≥–æ —Ü–∏–∫–ª–∞, —Å—á–∏—Ç–∞–µ–º —Ñ–æ—Ä–º—É–ª–æ–π: —Å—Ä–µ–¥–Ω–µ–µ 2 * buckets
    // –ù–æ –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ –∏ ¬´—à—É–º–∫–∞¬ª –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ—Å—á–∏—Ç–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 –±–∞–∫–µ—Ç–æ–≤ —è–≤–Ω–æ.
    if (buckets <= 200){
      for(let i=0;i<=buckets;i++) sum += bucketInc(i);
    } else {
      // –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ: —Å—Ä–µ–¥–Ω–µ–µ 2 * (buckets-200) + —Ç–æ—á–Ω—ã–π —Ö–≤–æ—Å—Ç
      sum += 2 * (buckets - 200);
      for(let i=buckets-200;i<=buckets;i++) sum += bucketInc(i);
    }
    return VIS_BASE + sum;
  }
  function renderVisitors(jumpOnce=false){
    const num = visitorsNow();
    const elNum = $("#visNum");
    elNum.textContent = num.toLocaleString('uk-UA');
    if(jumpOnce){
      elNum.animate([{transform:'scale(1)'},{transform:'scale(1.15)'},{transform:'scale(1)'}],{duration:400});
    }
  }
  setInterval(()=>renderVisitors(false), 15000);

  /* === –Ü–∫–æ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–≤–∞—à—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è) –∑ —Ñ–æ–ª–ª–±–µ–∫–æ–º === */
  const ICONS = {
    like: "https://ibb.co/4wsFcDjh",
    share:"https://ibb.co/fVMpJz36",
    eye:  "https://ibb.co/X1253RM",
    users:"https://ibb.co/fYqBCMS9"
  };
  function iconImg(src, alt, fallbackEmoji){
    const img = document.createElement('img');
    img.src = src; img.alt = alt; img.width = 16; img.height = 16; img.referrerPolicy = "no-referrer";
    img.style.display = 'inline-block';
    img.onerror = ()=>{ img.replaceWith(document.createTextNode(fallbackEmoji)); };
    return img;
  }

  /* ===== –ú—ñ—Å—Ü—è / –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–æ—â–æ (–±–µ–∑ –∑–º—ñ–Ω) ===== */
  const UA_REGIONS = {
    "–ö–∏—ó–≤—Å—å–∫–∞":["–ö–∏—ó–≤","–ë—ñ–ª–∞ –¶–µ—Ä–∫–≤–∞","–ë—Ä–æ–≤–∞—Ä–∏","–ë–æ—Ä–∏—Å–ø—ñ–ª—å","–Ü—Ä–ø—ñ–Ω—å","–ë—É—á–∞"],
    "–õ—å–≤—ñ–≤—Å—å–∫–∞":["–õ—å–≤—ñ–≤","–î—Ä–æ–≥–æ–±–∏—á","–ß–µ—Ä–≤–æ–Ω–æ–≥—Ä–∞–¥","–°—Ç—Ä–∏–π"],
    "–û–¥–µ—Å—å–∫–∞":["–û–¥–µ—Å–∞","–ß–æ—Ä–Ω–æ–º–æ—Ä—Å—å–∫","–Æ–∂–Ω–µ","–Ü–∑–º–∞—ó–ª","–ë—ñ–ª–≥–æ—Ä–æ–¥-–î–Ω—ñ—Å—Ç—Ä–æ–≤—Å—å–∫–∏–π"],
    "–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞":["–•–∞—Ä–∫—ñ–≤","–õ–æ–∑–æ–≤–∞","–Ü–∑—é–º"],
    "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞":["–î–Ω—ñ–ø—Ä–æ","–ö—Ä–∏–≤–∏–π –†—ñ–≥","–ö–∞–º'—è–Ω—Å—å–∫–µ","–ù—ñ–∫–æ–ø–æ–ª—å","–ü–∞–≤–ª–æ–≥—Ä–∞–¥"],
    "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞":["–ó–∞–ø–æ—Ä—ñ–∂–∂—è","–ú–µ–ª—ñ—Ç–æ–ø–æ–ª—å","–ë–µ—Ä–¥—è–Ω—Å—å–∫"],
    "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞":["–ú–∏–∫–æ–ª–∞—ó–≤","–ü–µ—Ä–≤–æ–º–∞–π—Å—å–∫","–Æ–∂–Ω–æ—É–∫—Ä–∞—ó–Ω—Å—å–∫"],
    "–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞":["–•–µ—Ä—Å–æ–Ω","–ù–æ–≤–∞ –ö–∞—Ö–æ–≤–∫–∞","–ö–∞—Ö–æ–≤–∫–∞"],
    "–í—ñ–Ω–Ω–∏—Ü—å–∫–∞":["–í—ñ–Ω–Ω–∏—Ü—è","–ñ–º–µ—Ä–∏–Ω–∫–∞","–ú–æ–≥–∏–ª—ñ–≤-–ü–æ–¥—ñ–ª—å—Å—å–∫–∏–π"],
    "–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞":["–ü–æ–ª—Ç–∞–≤–∞","–ö—Ä–µ–º–µ–Ω—á—É–∫","–ú–∏—Ä–≥–æ—Ä–æ–¥"],
    "–ß–µ—Ä–∫–∞—Å—å–∫–∞":["–ß–µ—Ä–∫–∞—Å–∏","–£–º–∞–Ω—å","–°–º—ñ–ª–∞"],
    "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞":["–ß–µ—Ä–Ω—ñ–≥—ñ–≤","–ù—ñ–∂–∏–Ω","–ü—Ä–∏–ª—É–∫–∏"],
    "–°—É–º—Å—å–∫–∞":["–°—É–º–∏","–®–æ—Å—Ç–∫–∞","–ö–æ–Ω–æ—Ç–æ–ø","–û—Ö—Ç–∏—Ä–∫–∞"],
    "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞":["–ñ–∏—Ç–æ–º–∏—Ä","–ë–µ—Ä–¥–∏—á—ñ–≤","–ö–æ—Ä–æ—Å—Ç–µ–Ω—å"],
    "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞":["–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π","–ö–∞–º'—è–Ω–µ—Ü—å-–ü–æ–¥—ñ–ª—å—Å—å–∫–∏–π","–®–µ–ø–µ—Ç—ñ–≤–∫–∞"],
    "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞":["–ß–µ—Ä–Ω—ñ–≤—Ü—ñ","–•–æ—Ç–∏–Ω"],
    "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞":["–†—ñ–≤–Ω–µ","–î—É–±–Ω–æ","–í–∞—Ä–∞—à"],
    "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞":["–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫","–ö–∞–ª—É—à","–ö–æ–ª–æ–º–∏—è","–Ø—Ä–µ–º—á–µ"],
    "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞":["–¢–µ—Ä–Ω–æ–ø—ñ–ª—å","–ß–æ—Ä—Ç–∫—ñ–≤","–ö—Ä–µ–º–µ–Ω–µ—Ü—å"],
    "–í–æ–ª–∏–Ω—Å—å–∫–∞":["–õ—É—Ü—å–∫","–ö–æ–≤–µ–ª—å","–í–æ–ª–æ–¥–∏–º–∏—Ä"],
    "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞":["–£–∂–≥–æ—Ä–æ–¥","–ú—É–∫–∞—á–µ–≤–æ","–•—É—Å—Ç"],
    "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞":["–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π","–û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ—è","–°–≤—ñ—Ç–ª–æ–≤–æ–¥—Å—å–∫"]
  };
  let PLACES = Object.keys(UA_REGIONS).flatMap(r => UA_REGIONS[r].map(n => ({region:r, name:n})));

  const ALL_CATS = [
    "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç","–ó–∞–ø—á–∞—Å—Ç–∏–Ω–∏ —Ç–∞ –∞–∫—Å–µ—Å—É–∞—Ä–∏","–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å","–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞",
    "–î—ñ–º —ñ —Å–∞–¥","–ú–µ–±–ª—ñ","–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞","–ë—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ —Ç–∞ —Ä–µ–º–æ–Ω—Ç",
    "–°–ø–æ—Ä—Ç —ñ –•–æ–±—ñ","–í–µ–ª–æ—Å–∏–ø–µ–¥–∏","–¢—É—Ä–∏–∑–º","–ú—É–∑–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏",
    "–ú–æ–¥–∞ —Ç–∞ —Å—Ç–∏–ª—å","–û–¥—è–≥","–í–∑—É—Ç—Ç—è","–ê–∫—Å–µ—Å—É–∞—Ä–∏",
    "–î–∏—Ç—è—á–∏–π —Å–≤—ñ—Ç","–Ü–≥—Ä–∞—à–∫–∏","–í—ñ–∑–æ—á–∫–∏","–û–¥—è–≥ –¥–ª—è –¥—ñ—Ç–µ–π",
    "–¢–≤–∞—Ä–∏–Ω–∏",
    "–ü–æ—Å–ª—É–≥–∏","–†–µ–º–æ–Ω—Ç","–î–æ—Å—Ç–∞–≤–∫–∞","–§–æ—Ç–æ/–í—ñ–¥–µ–æ","–û—Å–≤—ñ—Ç–∞","–õ–æ–≥—ñ—Å—Ç–∏–∫–∞",
    "–ë—ñ–∑–Ω–µ—Å —Ç–∞ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è","–°—ñ–ª—å—Å—å–∫–µ –≥–æ—Å–ø–æ–¥–∞—Ä—Å—Ç–≤–æ","–ö—Ä–∞—Å–∞ —Ç–∞ –∑–¥–æ—Ä–æ–≤‚Äô—è"
  ];
  const CONDS=["–ù–æ–≤–µ","–í–∂–∏–≤–∞–Ω–µ","–ü—ñ—Å–ª—è —Ä–µ–º–æ–Ω—Ç—É"];

  /* ===== –§–æ—Ç–æ-–ø—É–ª–∏ (–∫–∞–∫ –±—ã–ª–æ) ===== */
  const IMG = {
    car:[
      "https://upload.wikimedia.org/wikipedia/commons/8/8e/2017_Skoda_Octavia_SE_TDi_1.6_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/6/65/2018_Toyota_Camry_LE_front_6.22.18.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/b/b1/2018_BMW_320d_M_Sport_Automatic_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/e/ea/2018_Audi_A4_Sport_TDi_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/2/26/2018_Volkswagen_Golf_SE_NAV_TDi_1.6_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/1/1e/2018_Volvo_XC60_Momentum_D4_AWD_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/7/7f/2018_Kia_Sportage_3_CRDi_ISG_1.7_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/4/4e/2017_Hyundai_Tucson_Premium_SE_2.0.jpg"
    ],
    phone:[
      "https://upload.wikimedia.org/wikipedia/commons/9/94/Samsung_Galaxy_S21_5G.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/1/17/Google_Pixel_6_-_Retail_Package.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/3/3c/IPhone_13_Pro_Max_Alpine_Green.png"
    ],
    laptop:[
      "https://upload.wikimedia.org/wikipedia/commons/4/40/MacBook_Pro_16-inch.png",
      "https://upload.wikimedia.org/wikipedia/commons/4/45/Lenovo_ThinkPad_T440s.jpg"
    ],
    tv:[ "https://upload.wikimedia.org/wikipedia/commons/6/60/Modern_TV.jpg" ],
    washer:[ "https://upload.wikimedia.org/wikipedia/commons/5/5f/Washing_machine_bosch.jpg" ],
    sofa:[ "https://upload.wikimedia.org/wikipedia/commons/1/1d/Sofa_in_living_room.jpg" ],
    bike:[ "https://upload.wikimedia.org/wikipedia/commons/7/7b/Road_bicycle.jpg" ],
    dog:[ "https://upload.wikimedia.org/wikipedia/commons/6/6e/Golde33443.jpg" ],
    cat:[ "https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg" ],
    flat:[ "https://upload.wikimedia.org/wikipedia/commons/2/22/Minimalist_apartment_interior.jpg" ],
    tools:[ "https://upload.wikimedia.org/wikipedia/commons/2/2f/Hand_tools.jpg" ],
    decor:[ "https://upload.wikimedia.org/wikipedia/commons/0/0f/Scandinavian_interior_design.jpg" ],
    service:[ "https://upload.wikimedia.org/wikipedia/commons/6/6f/Electrician_at_work.jpg" ]
  };

  /* ===== Helpers ===== */
  const getDB=()=>{try{return JSON.parse(localStorage.getItem(DB_KEY)||"[]")}catch{return[]}};
  const setDB=v=>localStorage.setItem(DB_KEY,JSON.stringify(v));
  const getCtrl=()=>{try{return JSON.parse(localStorage.getItem(CTRL_KEY)||"{}")}catch{return{}}};
  const setCtrl=v=>localStorage.setItem(CTRL_KEY,JSON.stringify(v));
  const uid=()=>Math.random().toString(16).slice(2)+Date.now().toString(16);
  const pick=a=>a[Math.floor(Math.random()*a.length)];
  const round100 = v => Math.max(0, Math.round(v/100)*100);
  function fmtUA(date){ return new Date(date).toLocaleDateString('uk-UA'); }
  function lockScroll(on){ document.body.classList.toggle('modal-open', !!on); }
  function createImg(src, alt, fallback){
    const img=document.createElement("img"); img.loading="lazy"; img.alt=alt; img.referrerPolicy="no-referrer";
    img.src = src || fallback; img.onerror=()=>{ img.onerror=null; img.src=fallback; }; return img;
  }
  function itemPNG(title, seed=0){
    const c=document.createElement('canvas'); c.width=800; c.height=500; const g=c.getContext('2d');
    const palettes=[["#e9f7f1","#cdeee1","#a0dcc8"],["#fff2cf","#ffe6b3","#ffd289"],["#fbe3ea","#ffd6e0","#ffcad6"],["#e6f1ff","#cfe2ff","#b7d4ff"]];
    const pal=palettes[seed%palettes.length]; const grad=g.createLinearGradient(0,0,800,500);
    grad.addColorStop(0,pal[0]); grad.addColorStop(1,pal[1]); g.fillStyle=grad; g.fillRect(0,0,800,500);
    g.fillStyle=pal[2]; g.fillRect(0,420,800,80);
    g.fillStyle='#0f172a'; g.font="bold 42px 'Russo One', Arial"; g.textAlign="center"; g.fillText(title.slice(0,22), 400, 100);
    g.fillStyle="#00000022"; for(let i=0;i<6;i++){ g.fillRect(120+i*90,220+Math.sin(i+seed)*20,60,120); }
    return c.toDataURL('image/png');
  }

  /* ===== Nice Select (desktop) ===== */
  function enhanceSelect(sel){
    if (matchMedia('(hover: none)').matches) return;
    const wrap=document.createElement('div'); wrap.className='nice';
    const btn=document.createElement('button'); btn.type='button'; btn.className='nice-btn';
    const list=document.createElement('div'); list.className='nice-list';
    function refreshBtn(){ btn.textContent = sel.options[sel.selectedIndex]?.text || '–í–∏–±–µ—Ä—ñ—Ç—å'; }
    function rebuild(){
      list.innerHTML="";
      [...sel.options].forEach((o, idx)=>{
        const it=document.createElement('div'); it.className='nice-item'+(o.selected?' active':''); it.textContent=o.text;
        it.onclick=(ev)=>{ ev.stopPropagation(); sel.selectedIndex=idx; refreshBtn(); [...list.children].forEach(c=>c.classList.remove('active')); it.classList.add('active'); closeAll(); sel.dispatchEvent(new Event('change')); };
        list.appendChild(it);
      });
    }
    let activeList=null, activeWrap=null;
    function closeAll(e){
      if(activeList){
        if(e && (activeList.contains(e.target) || activeWrap.contains(e.target))) return;
        activeList.style.display='none'; activeWrap.appendChild(activeList); activeList=null; activeWrap=null;
      }
    }
    document.addEventListener('click', closeAll);
    rebuild();
    sel.classList.add('nice-hidden'); sel.parentNode.insertBefore(wrap, sel); wrap.appendChild(sel); wrap.appendChild(btn); refreshBtn();
    function open(){ closeAll(); const r=btn.getBoundingClientRect(); list.style.left = r.left+'px'; list.style.top = (r.bottom+6)+'px'; list.style.width = r.width+'px'; list.style.display='block'; document.body.appendChild(list); activeList=list; activeWrap=wrap; }
    btn.onclick=(e)=>{ e.stopPropagation(); if(activeList===list){ closeAll(); } else { rebuild(); open(); } };
  }

  /* ===== –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ===== */
  let SEED = 123456789;
  function rnd(){ SEED ^= (SEED << 13); SEED ^= (SEED >>> 17); SEED ^= (SEED << 5); return (SEED>>>0)/4294967296; }
  function sRand(a,b){ return Math.floor(rnd()*(b-a+1))+a; }
  function sPick(a){ return a[Math.floor(rnd()*a.length)] }

  const FIRSTNAMES=["–û–ª–µ–≥","–Ü—Ä–∏–Ω–∞","–°–µ—Ä–≥—ñ–π","–ê–Ω–Ω–∞","–í—ñ–∫—Ç–æ—Ä","–ú–∞–∫—Å–∏–º","–ú–∞—Ä—ñ—è","–Æ—Ä—ñ–π","–û–ª–µ–∫—Å—ñ–π","–ù–∞—Ç–∞–ª—ñ—è","–î–º–∏—Ç—Ä–æ","–û–ª–µ–Ω–∞","–ú–∏–∫–∏—Ç–∞","–ê–Ω–¥—Ä—ñ–π","–°–≤—ñ—Ç–ª–∞–Ω–∞"];
  const LASTNAMES=["–®–µ–≤—á–µ–Ω–∫–æ","–ö–æ–≤–∞–ª–µ–Ω–∫–æ","–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ","–¢–∫–∞—á–µ–Ω–∫–æ","–ö—Ä–∞–≤—á–µ–Ω–∫–æ","–ú–µ–ª—å–Ω–∏–∫","–ö–æ–≤–∞–ª—å—á—É–∫","–ü–µ—Ç—Ä–µ–Ω–∫–æ","–ü–æ–ª—ñ—â—É–∫","–ì—Ä–∏—Ü–µ–Ω–∫–æ","–°–∞–≤—á–µ–Ω–∫–æ","–ì–Ω–∞—Ç—é–∫","–Ø–∫–æ–≤–µ–Ω–∫–æ"];
  const OPERATORS=["50","63","66","67","68","73","93","95","96","97","98","99"];
  function genPhone(){ const op=sPick(OPERATORS); return `+380 (${op}) ${sRand(100,999)}-${sRand(10,99)}-${sRand(10,99)}`; }

  function imgPool(cat){
    if(cat==="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç") return IMG.car;
    if(cat==="–í–µ–ª–æ—Å–∏–ø–µ–¥–∏") return IMG.bike;
    if(cat==="–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞") return [...IMG.phone, ...IMG.laptop, ...IMG.tv];
    if(cat==="–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞") return [...IMG.washer];
    if(cat==="–ú–µ–±–ª—ñ"||cat==="–î—ñ–º —ñ —Å–∞–¥") return [...IMG.sofa, ...IMG.tools, ...IMG.decor];
    if(cat==="–¢–≤–∞—Ä–∏–Ω–∏") return [...IMG.dog, ...IMG.cat];
    if(cat==="–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å") return IMG.flat;
    if(cat==="–ü–æ—Å–ª—É–≥–∏") return IMG.service;
    return [...IMG.phone, ...IMG.tools, ...IMG.sofa];
  }
  function imgSetBy(cat, n=3){
    const pool = imgPool(cat);
    const out = [];
    for(let i=0;i<n;i++) out.push(pool[(i+sRand(0,pool.length-1))%pool.length]);
    return out;
  }

  function seedDB(){
    const out=[];
    const TEMPL = {
      "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç":[ "Skoda Octavia 1.6 TDI, {y} ‚Ä¢ —á–µ—Å–Ω–∏–π –ø—Ä–æ–±—ñ–≥","Toyota Camry 2.5, {y} ‚Ä¢ 1 –≤–ª–∞—Å–Ω–∏–∫","BMW 320d {y} ‚Ä¢ —Å–µ—Ä–≤—ñ—Å–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è","Audi A4 2.0 TDI {y} ‚Ä¢ —ñ–¥–µ–∞–ª","Volkswagen Golf 1.6 {y} ‚Ä¢ –µ–∫–æ–Ω–æ–º–Ω–∏–π" ],
      "–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞":[ "iPhone 13 128GB ‚Ä¢ —Å—Ç–∞–Ω 9/10", "Samsung S21 256GB ‚Ä¢ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π", "Pixel 6 128GB ‚Ä¢ –∑ —á–µ–∫–æ–º","MacBook Pro 16 {y} ‚Ä¢ i9/16/512" ],
      "–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å":[ "1–∫ —Ü–µ–Ω—Ç—Ä, {m} –º¬≤ ‚Ä¢ –Ω–æ–≤–æ–±—É–¥–æ–≤–∞","2–∫ –±—ñ–ª—è –º–µ—Ç—Ä–æ, {m} –º¬≤" ],
      "–ú–µ–±–ª—ñ":[ "–î–∏–≤–∞–Ω —Ä–æ–∑–∫–ª–∞–¥–Ω–∏–π ‚Ä¢ —è–∫ –Ω–æ–≤–∏–π","–°—Ç—ñ–ª –æ–±—ñ–¥–Ω—ñ–π –∑ –¥–µ—Ä–µ–≤–∞" ],
      "–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞":[ "–ü—Ä–∞–ª—å–Ω–∞ –º–∞—à–∏–Ω–∞ Bosch ‚Ä¢ —è–∫ –Ω–æ–≤–∞","–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ Samsung ‚Ä¢ NoFrost" ],
      "–í–µ–ª–æ—Å–∏–ø–µ–¥–∏":[ "–®–æ—Å–µ–π–Ω–∏–π –≤–µ–ª–æ—Å–∏–ø–µ–¥ ‚Ä¢ –∞–ª—é–º—ñ–Ω—ñ–π","MTB –∑ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü—ñ—î—é" ],
      "–¢–≤–∞—Ä–∏–Ω–∏":[ "–©–µ–Ω—è –≥–æ–ª–¥–µ–Ω —Ä–µ—Ç—Ä—ñ–≤–µ—Ä ‚Ä¢ –ø—Ä–∏–≤–∏–≤–∫–∏","–õ–∞–±—Ä–∞–¥–æ—Ä –¥–æ—Ä–æ—Å–ª–∏–π ‚Ä¢ –¥–æ–±—Ä–∏–π" ],
      "–ü–æ—Å–ª—É–≥–∏":[ "–†–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω—ñ–∫–∏ ‚Äî –≤–∏—ó–∑–¥","–ú–∞–π—Å—Ç–µ—Ä –Ω–∞ –≥–æ–¥–∏–Ω—É" ],
      "–î—ñ–º —ñ —Å–∞–¥":[ "–ù–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ ‚Ä¢ —è–∫ –Ω–æ–≤–∏–π","–î–µ–∫–æ—Ä —Å–∫–∞–Ω–¥–∏" ]
    };

    while(out.length<1000){
      const plc = PLACES[out.length % PLACES.length] || {region:"",name:""};
      const cat = sPick(ALL_CATS);
      const cond = sPick(CONDS);
      const base =
        (cat==="–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å") ? sRand(12000,180000) :
        (cat==="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç") ? sRand(20000,1200000) :
        (cat==="–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞"||cat==="–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞") ? sRand(1200,80000) :
        (cat==="–ü–æ—Å–ª—É–≥–∏") ? sRand(200,30000) :
        sRand(300,40000);
      const price = round100(base);
      const year = sRand(2006, 2025);
      const sM = sRand(25, 120);

      const tmpl = TEMPL[cat] && sPick(TEMPL[cat]);
      const baseTitle = tmpl ? tmpl.replace("{y}", year).replace("{m}", sM) : `${cat}`;
      const title = baseTitle.replace(/‚Äî?\s*–ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è/gi,'').trim();

      const created = Date.now() - sRand(0, 60*86400*1000);
      const views = sRand(100, 600);
      const likes = Math.min(999, Math.round(views/25)+sRand(0,10));
      const images = imgSetBy(cat, 3);
      const name = `${sPick(FIRSTNAMES)} ${sPick(LASTNAMES)}`;

      out.push({
        id: `L${out.length.toString(36)}${year.toString(36)}`,
        region: plc.region,
        city: plc.name,
        cat, cond, title,
        price, currency:"‚Ç¥",
        created, views, likes,
        desc: "–†–µ–∞–ª—å–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ—Ç–∞—î—Ç—å—Å—è. –í—ñ–¥–ø—Ä–∞–≤–ª—é –ù–æ–≤–æ—é –ø–æ—à—Ç–æ—é –∞–±–æ –∑—É—Å—Ç—Ä—ñ—á —É —Ü–µ–Ω—Ç—Ä—ñ.",
        images,
        contact: {name, phone: genPhone()},
        hot: (sRand(1,100)<=15)
      });
    }
    setDB(out);
    localStorage.setItem(VER_KEY, "1");
  }

  /* ===== HOT ===== */
  function ensureHot(){
    const db = getDB().filter(x=>x.hot===true);
    if(!db.length){ $("#hotPanel").style.display="none"; $("#hotSplit").style.display="none"; return; }
    const now = Date.now();
    const scored = db.map(x => ({
      id: x.id,
      score: (x.likes||0)*6 + (x.views||0) + Math.max(0, 2000 - (now - x.created)/1000)
    })).sort((a,b)=>b.score-a.score);
    const topIds = scored.slice(0, Math.min(10, scored.length)).map(s=>s.id);
    renderHot(topIds);
  }
  function renderHot(ids){
    const grid=$("#hotGrid"); grid.innerHTML="";
    const db = getDB();
    const items = ids.map(id => db.find(x=>x.id===id)).filter(Boolean);
    if(items.length){
      $("#hotPanel").style.display="block";
      $("#hotSplit").style.display="block";
      items.forEach(it=>{
        const card=document.createElement('div'); card.className='hotCard'; card.onclick=()=>openDetail(it.id);
        const fallback=itemPNG(it.title,(it.price+it.created)%7);
        const thumb=document.createElement('div'); thumb.className='thumb';
        const badge=document.createElement('div'); badge.className='hotBadge'; badge.textContent='HOT';
        const price=document.createElement('button'); price.className='hotPrice'; price.textContent=`${it.price.toLocaleString('uk-UA')} ${it.currency}`;
        thumb.appendChild(createImg((it.images&&it.images[0])||"", it.title, fallback));
        thumb.appendChild(badge); thumb.appendChild(price);
        const body=document.createElement('div'); body.className='hotBody';
        body.innerHTML=`<div class="hotTTL" style="color:#0f172a">${it.title}</div>
                        <div style="opacity:.85;color:#0f172a">${it.city} ‚Ä¢ ${it.cat}</div>
                        <div style="opacity:.85;color:#0f172a"><span class="pillIcon">${iconImg(ICONS.like,'like','‚ô•').outerHTML}</span> ${it.likes||0} ‚Ä¢ <span class="pillIcon">${iconImg(ICONS.eye,'views','üëÅ').outerHTML}</span> ${it.views||0}</div>`;
        card.appendChild(thumb); card.appendChild(body);
        grid.appendChild(card);
      });
    } else {
      $("#hotPanel").style.display="none";
      $("#hotSplit").style.display="none";
    }
  }

  /* ===== –†–µ–∫–ª–∞–º–∞ (–±–µ–∑ –ø–ª—é—Å-–∫–Ω–æ–ø–∫–∏) ===== */
  function startAd(){ $("#adImg").src=""; /* –ø–æ–∑–∂–µ —Å–µ—Ä–≤–µ—Ä –ø–æ–¥—Å—Ç–∞–≤–∏—Ç */ }

  /* ===== –î–æ–¥–∞–≤–∞–Ω–Ω—è ===== */
  function initSellForm(){
    $("#sCat").innerHTML=ALL_CATS.map(x=>`<option value="${x}">${x}</option>`).join('');
    $("#sCond").innerHTML=CONDS.map(x=>`<option value="${x}">${x}</option>`).join('');
    $$('.select').forEach(enhanceSelect);
  }
  initSellForm();

  async function filesToDataURLs(inputEl){
    const files = [...(inputEl.files||[])].slice(0,6);
    const tasks = files.map(f => new Promise(res=>{
      const r=new FileReader(); r.onload=()=>res(r.result); r.readAsDataURL(f);
    }));
    return await Promise.all(tasks);
  }

  let postMode="normal"; // "normal" | "hot"
  function setPostMode(mode){
    postMode=mode;
    $("#sellModeBadge").textContent = (mode==="hot"?"HOT":"–ó–≤–∏—á–∞–π–Ω–µ");
    $("#sellModeBadge").className = "pill " + (mode==="hot"?"":"green");
  }

  $("#sSave").onclick=async ()=>{
    const region=$("#sRegion").value.trim(), city=$("#sCity").value.trim(), cat=$("#sCat").value, title=$("#sTitle").value.trim();
    if(!region||!city||!cat||!title) return alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–±–ª–∞—Å—Ç—å/–º—ñ—Å—Ç–æ/–∫–∞—Ç–µ–≥–æ—Ä—ñ—é/–∑–∞–≥–æ–ª–æ–≤–æ–∫.");
    const priceRaw=+(($("#sPrice").value||0)); if(!(priceRaw>=0 && priceRaw<=100000000)) return alert("–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—ñ–Ω—É.");
    const price = round100(priceRaw);
    const phone=$("#sPhone").value.trim(); if(phone && !/^\+?\d[\d\s\-\(\)]{8,}$/.test(phone)) return alert("–¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π.");
    const desc=$("#sDesc").value.trim(); if(desc.length<20) return alert("–û–ø–∏—Å ‚â• 20 —Å–∏–º–≤–æ–ª—ñ–≤.");
    const cond=$("#sCond").value;

    const imgs = await filesToDataURLs($("#sImages"));
    const db=getDB();
    db.unshift({
      id: uid(), region, city,
      cat, title: title.replace(/‚Äî?\s*–ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è/gi,'').trim(), price, currency:"‚Ç¥", cond, created:Date.now(),
      views: 0, likes:0,
      desc, images: imgs.length? imgs : imgSetBy(cat, 3),
      contact:{name:"–ü—Ä–æ–¥–∞–≤–µ—Ü—å", phone: phone||genPhone()},
      hot: (postMode==="hot")
    });
    setDB(db);
    alert("–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ.");
    $("#sTitle").value=""; $("#sPrice").value=""; $("#sPhone").value=""; $("#sDesc").value=""; $("#sImages").value=""; $("#sRegion").value=""; $("#sCity").value="";
    $("#sellOverlay").classList.remove('on'); lockScroll(false); setPostMode("normal"); applyFilters(); ensureHot();
  };

  /* ===== –ü–æ—à—É–∫ (–∫–ª—é—á–æ–≤–µ —Å–ª–æ–≤–æ —É –∑–∞–≥–æ–ª–æ–≤–∫—É) ===== */
  const grid=$("#grid"), btnMore=$("#btnMore");
  const fltQuery=$("#fltQuery");
  let page=0, pageSize=24, lastResults=[];

  function applyFilters(){
    const q=(fltQuery.value||"").trim().toLowerCase();
    let arr=getDB().filter(it=> !q || (it.title||"").toLowerCase().includes(q) );
    arr.sort((a,b)=> b.created-a.created );
    lastResults=arr; page=0; grid.innerHTML="";
    renderMore();
  }
  function remainingCount(){ return Math.max(0, lastResults.length - page*pageSize); }
  function updateMoreUI(){ btnMore.style.display = remainingCount()>0 ? "inline-flex" : "none"; }
  function renderMore(){ const slice=lastResults.slice(page*pageSize,(page+1)*pageSize); slice.forEach(renderCard); page++; updateMoreUI(); }

  function like(id){
    const db=getDB(); const idx=db.findIndex(x=>x.id===id); if(idx<0) return false;
    const ctrl=getCtrl(); ctrl.liked = ctrl.liked||{};
    if(ctrl.liked[id]){ return false; }
    db[idx].likes = (db[idx].likes||0) + 1;
    setDB(db); ctrl.liked[id]=true; setCtrl(ctrl);
    return true;
  }

  function renderCard(it){
    const el=document.createElement('article'); el.className="card"; el.setAttribute('role','button'); el.title="–î–∏–≤–∏—Ç–∏—Å—è";
    const fallback=itemPNG(it.title, (it.price+it.created)%7);
    const firstImg=(Array.isArray(it.images)&&it.images.length)?it.images[0]:null;
    el.innerHTML=`
      <div class="thumb">
        <div class="viewPill"><span class="pillIcon">${iconImg(ICONS.eye,'views','üëÅ').outerHTML}</span> <span>${it.views||0}</span></div>
        <button class="shareBtn" title="–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è" aria-label="–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è"><span class="pillIcon">${iconImg(ICONS.share,'share','üîó').outerHTML}</span></button>
        <button class="likeBtn" title="–õ–∞–π–∫" aria-label="–õ–∞–π–∫"><span class="pillIcon">${iconImg(ICONS.like,'like','‚ô•').outerHTML}</span> <span>${it.likes||0}</span></button>
        <div class="badge">${it.price.toLocaleString('uk-UA')} ${it.currency||"‚Ç¥"}</div>
      </div>
      <div class="body">
        <div class="title">${it.title}</div>
        <div class="meta" style="color:var(--muted)">${it.cat} ‚Ä¢ ${it.cond}</div>
        <div class="meta" style="color:var(--muted)">${it.region} ‚Ä¢ ${it.city}</div>
      </div>`;
    const likeButton = el.querySelector(".likeBtn");
    likeButton.addEventListener('mousedown', e=>e.preventDefault());
    likeButton.onclick=(e)=>{
      e.stopPropagation();
      if(like(it.id)){
        it.likes=(it.likes||0)+1;
        likeButton.querySelector("span:last-child").textContent = it.likes;
        ensureHot();
      }
    };
    const shareBtn = el.querySelector(".shareBtn");
    shareBtn.addEventListener('mousedown', e=>e.preventDefault());
    shareBtn.onclick=(e)=>{ e.stopPropagation(); shareItem(it); };

    el.querySelector(".thumb").prepend(createImg(firstImg, it.title, fallback));
    el.onclick=()=>openDetail(it.id);
    grid.appendChild(el);
  }

  const dLikeBtn = $("#dLike"), dLikeCnt = $("#dLikeCnt");
  let galIndex=0, galImgs=[], currentId=null, currentItem=null;

  function renderGallery(title){
    const gal=$("#dGal");
    gal.innerHTML=`<div class="big"><button class="navBtn navPrev" id="galPrev" aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—î">‚Äπ</button><button class="navBtn navNext" id="galNext" aria-label="–ù–∞—Å—Ç—É–ø–Ω–µ">‚Ä∫</button></div>`;
    const big=gal.querySelector('.big'); const url=galImgs[galIndex];
    big.appendChild(createImg(url, 'photo', itemPNG(title,galIndex)));
    $("#galPrev").onclick=()=>{ galIndex=(galIndex-1+galImgs.length)%galImgs.length; renderGallery(title); };
    $("#galNext").onclick=()=>{ galIndex=(galIndex+1)%galImgs.length; renderGallery(title); };
  }

  function openDetail(id){
    const db=getDB(); const idx=db.findIndex(x=>x.id===id); if(idx<0) return;
    currentId=id; currentItem=db[idx];
    currentItem.views=(currentItem.views||0)+1; db[idx]=currentItem; setDB(db);

    const d=$("#detail"); d.classList.add('active'); d.setAttribute('aria-hidden','false'); lockScroll(true);
    $("#dClose").onclick=()=>{ d.classList.remove('active'); d.setAttribute('aria-hidden','true'); lockScroll(false); applyFilters(); ensureHot(); };

    $("#dHeader").innerHTML=`
      <div class="title" style="font:700 20px/1.2 'Russo One'; color:#0f172a">${currentItem.title}</div>
      <div class="pill green" style="height:38px;line-height:38px;border-radius:12px">‚Ç¥ ${currentItem.price.toLocaleString('uk-UA')}</div>
      <div class="pill" style="margin-left:auto">
        <span class="pillIcon">${iconImg(ICONS.eye,'views','üëÅ').outerHTML}</span> ${currentItem.views}
      </div>`;
    const imgs=(Array.isArray(currentItem.images)&&currentItem.images.length)?currentItem.images:[itemPNG(currentItem.title,0),itemPNG(currentItem.title,1),itemPNG(currentItem.title,2)];
    galImgs = imgs; galIndex=0; renderGallery(currentItem.title);

    $("#dSpecs").innerHTML=
      `<div class="spec"><div class="h">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</div>${currentItem.cat}</div>`+
      `<div class="spec"><div class="h">–°—Ç–∞–Ω</div>${currentItem.cond}</div>`+
      `<div class="spec"><div class="h">–û–±–ª–∞—Å—Ç—å</div>${currentItem.region}</div>`+
      `<div class="spec"><div class="h">–ú—ñ—Å—Ç–æ</div>${currentItem.city}</div>`+
      `<div class="spec"><div class="h">–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ</div>${fmtUA(currentItem.created)}</div>`;

    $("#dDesc").textContent = currentItem.desc||"";
    const initials=(currentItem.contact?.name||"–ü")[0];
    $("#dSeller").innerHTML=`<div class="avatar">${initials}</div><div><div class="h">–ü—Ä–æ–¥–∞–≤–µ—Ü—å</div><div>${currentItem.contact?.name||"
       $("#dSeller").innerHTML=`<div class="avatar">${initials}</div><div><div class="h">–ü—Ä–æ–¥–∞–≤–µ—Ü—å</div><div>${currentItem.contact?.name||"–ü—Ä–æ–¥–∞–≤–µ—Ü—å"}</div><div style="opacity:.85">${currentItem.contact?.phone||"‚Äî"}</div></div>`;

    // –ò–∫–æ–Ω–∫–∏ –≤ —à–∞–ø–∫–µ –º–æ–¥–∞–ª–∫–∏
    const likeIconEl = $("#dLikeIcon"); likeIconEl.replaceChildren(iconImg(ICONS.like,'like','‚ô•'));
    const shareIconEl = $("#dShareIcon"); shareIconEl.replaceChildren(iconImg(ICONS.share,'share','üîó'));

    // –ö–Ω–æ–ø–∫–∏ –ª–∞–π–∫–∞/—à–µ—Ä—ñ–Ω–≥—É –≤ –¥–µ—Ç–∞–ª—Ü—ñ
    dLikeCnt.textContent = currentItem.likes||0;
    dLikeBtn.onclick=()=>{ if(like(currentId)){ currentItem.likes=(currentItem.likes||0)+1; dLikeCnt.textContent = currentItem.likes; applyFilters(); ensureHot(); } };
    $("#dShare").onclick=()=>shareItem(currentItem);
  }

  /* ===== –®–µ—Ä—ñ–Ω–≥ (–∫–∞—Ä—Ç–∏–Ω–∫–∞ + –æ–ø–∏—Å + –ø–æ—Å–∏–ª–∞–Ω–Ω—è) ===== */
  function shareItem(it){
    const url = location.origin + location.pathname + `#${encodeURIComponent(it.id)}`;
    const text = (it.desc||'').slice(0,280);
    const title = `KOLO ‚Ä¢ ${it.title}`;
    // –ü—ã—Ç–∞–µ–º—Å—è —á–µ—Ä–µ–∑ Web Share
    if (navigator.share){
      navigator.share({ title, text, url }).catch(()=>copyFallback());
    } else {
      copyFallback();
    }
    function copyFallback(){
      const firstImg = (Array.isArray(it.images)&&it.images[0]) ? it.images[0] : '';
      const payload = `${title}\n${text}\n${firstImg}\n${url}`;
      navigator.clipboard?.writeText(payload).then(()=>alert("–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É."), ()=>alert("–°–∫–æ–ø—ñ—é–π—Ç–µ –≤—Ä—É—á–Ω—É:\n\n"+payload));
    }
  }

  /* ===== –°–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è —ñ –ë–î ===== */
  function sanitizeDB(){
    let db=getDB(); let changed=false;
    db = db.map(it=>{
      const t=it.title||"";
      const nt=t.replace(/‚Äî?\s*–ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è/gi,'').trim();
      if(nt!==t){ it.title=nt; changed=true; }
      if(typeof it.views!=='number') { it.views = 0; changed=true; }
      if(typeof it.likes!=='number') { it.likes = 0; changed=true; }
      if(typeof it.hot!=='boolean'){ it.hot=false; changed=true; }
      return it;
    });
    if(changed){ setDB(db); }
  }

  /* ===== –í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ: —ñ–∫–æ–Ω–∫–∞ + —Ä–µ–Ω–¥–µ—Ä ===== */
  (function initVisitorsUI(){
    const iconWrap = $("#visIcon");
    if(iconWrap && !iconWrap.firstChild){ iconWrap.appendChild(iconImg(ICONS.users,'users','üë•')); }
    renderVisitors(true);
  })();

  /* ===== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ===== */
  (function init(){
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–µ–∫–ª–∞–º—É (–∫–∞—Ä—Ç–∏–Ω–∫—É –ø–æ–¥—Å—Ç–∞–≤–∏—Ç —Å–µ—Ä–≤–µ—Ä)
    startAd();

    // DB
    if(!localStorage.getItem(VER_KEY) || !getDB().length){ seedDB(); } else { sanitizeDB(); }

    // –§–æ—Ä–º–∞/—Ñ–∏–ª—å—Ç—Ä—ã/—Å–ø–∏—Å–∫–∏
    applyFilters();
    ensureHot();

    // –õ–æ–∞–¥–µ—Ä 5 —Å–µ–∫, –∑–∞—Ç–µ–º —Å–∫—Ä—ã—Ç—å
    const boot = $("#boot");
    setTimeout(()=>{
      if(boot){
        boot.animate([{opacity:1},{opacity:0}],{duration:350,fill:'forwards'}).onfinish=()=>boot.remove();
      }
    }, 5000);
  })();

  /* ===== –í–∫–ª–∞–¥–∫–∏ + –º–æ–¥–∞–ª—ñ ===== */
  $("#tabSearch").onclick=()=>{ $("#searchOverlay").classList.add('on'); $("#searchOverlay").setAttribute('aria-hidden','false'); lockScroll(true); };
  $("#searchClose").onclick=()=>{ $("#searchOverlay").classList.remove('on'); $("#searchOverlay").setAttribute('aria-hidden','true'); lockScroll(false); };

  $("#tabSell").onclick=()=>{ $("#sellChoiceOverlay").classList.add('on'); $("#sellChoiceOverlay").setAttribute('aria-hidden','false'); lockScroll(true); };
  $("#choiceClose").onclick=()=>{ $("#sellChoiceOverlay").classList.remove('on'); $("#sellChoiceOverlay").setAttribute('aria-hidden','true'); lockScroll(false); };
  const openSellForm=(mode)=>{ setPostMode(mode); $("#sellChoiceOverlay").classList.remove('on'); $("#sellOverlay").classList.add('on'); $("#sellOverlay").setAttribute('aria-hidden','false'); };
  $("#chooseNormal").onclick=()=>openSellForm("normal");
  $("#chooseHot").onclick=()=>openSellForm("hot");

  $("#sellClose").onclick=()=>{ $("#sellOverlay").classList.remove('on'); $("#sellOverlay").setAttribute('aria-hidden','true'); setPostMode("normal"); lockScroll(false); };

  $("#btnApply").onclick=()=>{ applyFilters(); $("#searchOverlay").classList.remove('on'); lockScroll(false); };
  $("#btnReset").onclick=()=>{ $("#fltQuery").value=""; applyFilters(); };

  btnMore.onclick=renderMore;

  document.addEventListener('keydown', (e)=>{ 
    if(e.key==='Escape'){
      $("#detail").classList.remove('active');
      $("#sellOverlay").classList.remove('on');
      $("#searchOverlay").classList.remove('on');
      $("#sellChoiceOverlay").classList.remove('on');
      lockScroll(false);
    }
  });

  // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º "–≥–ª—é–∫" –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –ª–∞–π–∫—É (—Ñ–æ–∫—É—Å/—Å–∫—Ä–æ–ª–ª)
  document.addEventListener('mousedown', (e)=>{
    const t=e.target;
    if(t.closest('.likeBtn')||t.closest('.shareBtn')){ e.preventDefault(); }
  });
  </script>
</body>
</html>
