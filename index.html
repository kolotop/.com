<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>KOLO ‚Äî –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è —Ç–∞ —Ä–æ–±–æ—Ç–∞</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Russo+One&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#ffffff;
    --ink:#111827;
    --muted:#6b7280;
    --brand:#12b76a; /* –∑–µ–ª–µ–Ω–∏–π */
    --brand-2:#0ea862;
    --line:#e5e7eb;
    --chip:#f0fdf4;
    --danger:#ef4444;
    --gold:#f59e0b;
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:14px/1.45 Montserrat,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  *{box-sizing:border-box}
  a{color:inherit}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}

  /* Header */
  .head{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid var(--line)}
  .head .bar{display:flex;align-items:center;gap:12px;justify-content:space-between;padding:12px 16px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{width:40px;height:40px;border-radius:12px;background:conic-gradient(from 90deg at 50% 50%, #12b76a, #16a34a, #22c55e, #16a34a);box-shadow:0 4px 16px rgba(18,183,106,.35)}
  .title{font:700 20px/1 "Russo One", Montserrat, sans-serif;letter-spacing:.5px}
  .controls{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer;transition:.15s ease;user-select:none;white-space:nowrap}
  .btn:hover{border-color:#cbd5e1;box-shadow:0 2px 10px rgba(0,0,0,.06)}
  .btn.brand{background:var(--brand);border-color:var(--brand);color:#fff}
  .btn.brand:hover{background:var(--brand-2)}
  .pill{padding:8px 12px;border-radius:999px;background:var(--chip);border:1px solid #dcfce7;color:#065f46;font-weight:600}
  .kpi{display:flex;align-items:center;gap:10px}
  .kpi .num{font-weight:700}
  .kpi small{color:var(--muted)}

  /* Tabs */
  .tabs{display:flex;gap:8px;border-bottom:1px solid var(--line);padding:8px 16px;background:#fff}
  .tab{padding:10px 14px;border-radius:12px;cursor:pointer;border:1px solid transparent}
  .tab.active{border-color:var(--brand);background:#ecfdf5;color:#065f46;font-weight:700}

  /* Filters */
  .filters{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;padding:12px 16px}
  .field{display:flex;flex-direction:column;gap:6px}
  .field label{font-weight:600;font-size:12px;color:#065f46}
  .input, select{border:1px solid var(--line);border-radius:10px;padding:10px 12px;font:inherit}

  /* Top strip */
  .top-strip{padding:12px 16px}
  .top-row{display:grid;grid-auto-flow:column;grid-auto-columns:280px;gap:12px;overflow:auto;padding-bottom:4px}
  .chip-top{display:flex;gap:6px;align-items:center;font-weight:700;color:#92400e;background:#fffbeb;border:1px solid #fde68a;padding:4px 8px;border-radius:999px}

  /* Grid */
  .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:12px 16px}
  .card{border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#fff;display:flex;flex-direction:column}
  .thumb{aspect-ratio:4/3;background:#f3f4f6;position:relative}
  .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .badge-top{position:absolute;top:10px;left:10px}
  .body{padding:12px;display:flex;flex-direction:column;gap:8px}
  .title-2{font-weight:700}
  .meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted)}
  .price{font-weight:800;color:#065f46}
  .muted{color:var(--muted)}
  .actions{display:flex;gap:8px;margin-top:auto}

  /* Modal */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px;z-index:100}
  .overlay.on{display:flex}
  .modal{width:min(720px, 96vw);max-height:92vh;overflow:auto;background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.25)}
  .modal .head{border-bottom:1px solid var(--line)}
  .modal .head .bar{padding:12px 16px}
  .modal .content{padding:16px}
  .modal .grid{grid-template-columns:1fr 1fr}

  .note{font-size:12px;color:var(--muted)}
  .danger{color:var(--danger)}
  .gold{color:#92400e}

  /* Responsive */
  @media (max-width:1024px){
    .grid{grid-template-columns:repeat(3,1fr)}
    .filters{grid-template-columns:1fr 1fr}
  }
  @media (max-width:720px){
    .grid{grid-template-columns:repeat(2,1fr)}
    .top-row{grid-auto-columns:74vw}
    .controls{gap:6px}
  }
  @media (max-width:460px){
    .grid{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <header class="head">
    <div class="bar wrap">
      <div class="brand">
        <div class="logo" aria-hidden></div>
        <div>
          <div class="title">KOLO</div>
          <div class="muted" style="font-size:12px">–û–≥–æ–ª–æ—à–µ–Ω–Ω—è ‚Ä¢ –¢–æ–≤–∞—Ä–∏ ‚Ä¢ –ü–æ—Å–ª—É–≥–∏ ‚Ä¢ –†–æ–±–æ—Ç–∞</div>
        </div>
      </div>
      <div class="controls">
        <div class="kpi"><span class="pill">–í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω: 29 –≥—Ä–Ω/–º—ñ—Å—è—Ü—å</span></div>
        <button id="btnAdd" class="btn brand">+ –î–æ–¥–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</button>
        <div class="kpi" title="–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤ —Å–∞–π—Ç—É (–ø—É–±–ª—ñ—á–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫)">
          <small>–í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤:</small>
          <span class="num" id="visitorsNum">121‚ÄØ369</span>
        </div>
      </div>
    </div>
    <div class="tabs wrap" id="tabs">
      <div class="tab active" data-tab="all">–£—Å—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</div>
      <div class="tab" data-tab="jobs">–†–æ–±–æ—Ç–∞</div>
      <div class="tab" data-tab="services">–ü–æ—Å–ª—É–≥–∏</div>
      <div class="tab" data-tab="goods">–¢–æ–≤–∞—Ä–∏</div>
      <div class="tab" data-tab="realty">–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å</div>
      <div class="tab" data-tab="auto">–ê–≤—Ç–æ</div>
    </div>
  </header>

  <section class="filters wrap">
    <div class="field">
      <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
      <select id="filterCategory"></select>
    </div>
    <div class="field">
      <label>–ú—ñ—Å—Ç–æ/–†–µ–≥—ñ–æ–Ω</label>
      <input id="filterCity" class="input" placeholder="–û–¥–µ—Å–∞, –ö–∏—ó–≤, –õ—å–≤—ñ–≤‚Ä¶" />
    </div>
    <div class="field">
      <label>–ü–æ—à—É–∫</label>
      <input id="filterQ" class="input" placeholder="–©–æ —à—É–∫–∞—î—Ç–µ?" />
    </div>
    <div class="field">
      <label>–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</label>
      <select id="filterSort">
        <option value="new">–°–ø–æ—á–∞—Ç–∫—É –Ω–æ–≤—ñ</option>
        <option value="cheap">–°–ø–æ—á–∞—Ç–∫—É –¥–µ—à–µ–≤—ñ</option>
        <option value="exp">–°–ø–æ—á–∞—Ç–∫—É –¥–æ—Ä–æ–∂—á—ñ</option>
        <option value="views">–ó–∞ –ø–µ—Ä–µ–≥–ª—è–¥–∞–º–∏</option>
      </select>
    </div>
  </section>

  <section class="top-strip wrap">
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
      <span class="chip-top">TOP 7 –¥–Ω—ñ–≤</span>
      <span class="note">–ü—ñ–¥–Ω—è—Ç—Ç—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—ñ–π ‚Äî <b>299 –≥—Ä–Ω</b> –Ω–∞ 7 –¥–Ω—ñ–≤.</span>
    </div>
    <div id="topRow" class="top-row"></div>
  </section>

  <main class="wrap">
    <div id="grid" class="grid"></div>
  </main>

  <!-- Modal: Add Listing (gated by 40 UAH) -->
  <div class="overlay" id="overlayAdd">
    <div class="modal">
      <div class="head"><div class="bar"><b>–î–æ–¥–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</b><div class="muted">–†–æ–∑–º—ñ—â–µ–Ω–Ω—è ‚Äî 40 –≥—Ä–Ω / 30 –¥–Ω—ñ–≤</div></div></div>
      <div class="content">
        <div id="addGate" style="display:none">
          <p><b>–û–ø–ª–∞—Ç—ñ—Ç—å 40 –≥—Ä–Ω</b>, —â–æ–± —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –Ω–∞ 30 –¥–Ω—ñ–≤.</p>
          <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
            <a id="pay40" class="btn brand" target="_blank" rel="noopener">–û–ø–ª–∞—Ç–∏—Ç–∏ 40 –≥—Ä–Ω —É Privat24</a>
            <button class="btn" id="btnPaid40">–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)</button>
            <span class="note">–ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)¬ª.</span>
          </div>
          <p class="note">‚ö†Ô∏è –ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –≤–µ—Ä—Å—ñ—è —Å–∞–π—Ç—É –Ω–µ –º–æ–∂–µ —Ç–µ—Ö–Ω—ñ—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π —Ñ–∞–∫—Ç –ø–ª–∞—Ç–µ–∂—É –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó. –£ —Ü—ñ–π –¥–µ–º–æ‚Äë–≤–µ—Ä—Å—ñ—ó –¥–æ—Å—Ç—É–ø –Ω–∞–¥–∞—î—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –î–ª—è –±–æ–π–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫—É –ø—ñ–¥‚Äô—î–¥–Ω–∞–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —á–µ—Ä–µ–∑ API/–≤–µ–±—Ö—É–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Privat24/LiqPay/Fondy) ‚Äî –¥–∏–≤. –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –≤ –∫–æ–¥—ñ.</p>
        </div>
        <form id="formAdd" style="display:none">
          <div class="grid">
            <div class="field"><label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
              <select id="fCat" required></select>
            </div>
            <div class="field"><label>–ü—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
              <input id="fSub" class="input" placeholder="–ù–∞–ø—Ä.: –°–º–∞—Ä—Ç—Ñ–æ–Ω–∏ / –ö—É—Ö–æ–Ω–Ω—ñ –ø–æ—Å–ª—É–≥–∏ / –í–∞–∫–∞–Ω—Å—ñ—è" required />
            </div>
            <div class="field"><label>–ú—ñ—Å—Ç–æ</label>
              <input id="fCity" class="input" placeholder="–û–¥–µ—Å–∞" required />
            </div>
            <div class="field"><label>–¶—ñ–Ω–∞ (–≥—Ä–Ω)</label>
              <input id="fPrice" class="input" type="number" min="0" step="1" required />
            </div>
            <div class="field" style="grid-column:1/-1"><label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
              <input id="fTitle" class="input" maxlength="120" required />
            </div>
            <div class="field" style="grid-column:1/-1"><label>–û–ø–∏—Å</label>
              <textarea id="fDesc" class="input" rows="4" required></textarea>
            </div>
            <div class="field"><label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É (–ø–æ–±–∞—á–∞—Ç—å –ª–∏—à–µ –∑ –ø—ñ–¥–ø–∏—Å–∫–æ—é)</label>
              <input id="fPhone" class="input" placeholder="+380501234567" required />
            </div>
            <div class="field"><label>–§–æ—Ç–æ (1‚Äì6)</label>
              <input id="fImages" class="input" type="file" accept="image/*" multiple />
              <div id="fPreviews" class="meta" style="margin-top:6px;gap:6px"></div>
            </div>
            <div class="field" style="grid-column:1/-1">
              <label><input type="checkbox" id="fTop" /> –ü—ñ–¥–Ω—è—Ç–∏ –≤ TOP (299 –≥—Ä–Ω / 7 –¥–Ω—ñ–≤)</label>
              <div style="display:flex;gap:10px;align-items:center;margin-top:6px" id="topPayRow">
                <a id="pay299" class="btn" target="_blank" rel="noopener">–û–ø–ª–∞—Ç–∏—Ç–∏ 299 –≥—Ä–Ω —É Privat24</a>
                <button class="btn" id="btnPaid299" type="button">–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞) 299</button>
                <span class="note">TOP –¥—ñ—î 7 –¥–Ω—ñ–≤ –≤—ñ–¥ –º–æ–º–µ–Ω—Ç—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó.</span>
              </div>
            </div>
          </div>
          <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
            <button type="button" class="btn" id="btnCloseAdd">–ó–∞–∫—Ä–∏—Ç–∏</button>
            <button class="btn brand" type="submit">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal: Subscription for phones (29 UAH) -->
  <div class="overlay" id="overlaySub">
    <div class="modal">
      <div class="head"><div class="bar"><b>–ü–æ–∫–∞–∑–∞—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É</b><div class="muted">–ü–æ—Ç—Ä—ñ–±–Ω–∞ –ø—ñ–¥–ø–∏—Å–∫–∞ ‚Äî 29 –≥—Ä–Ω / 30 –¥–Ω—ñ–≤</div></div></div>
      <div class="content">
        <p>–û—Ñ–æ—Ä–º—ñ—Ç—å –ø—ñ–¥–ø–∏—Å–∫—É, —â–æ–± –±–∞—á–∏—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∏ —É –≤—Å—ñ—Ö –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è—Ö –ø—Ä–æ—Ç—è–≥–æ–º 30 –¥–Ω—ñ–≤.</p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
          <a id="pay29" class="btn brand" target="_blank" rel="noopener">–û–ø–ª–∞—Ç–∏—Ç–∏ 29 –≥—Ä–Ω —É Privat24</a>
          <button class="btn" id="btnPaid29">–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)</button>
          <span class="note">–ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)¬ª.</span>
        </div>
        <p class="note">‚ö†Ô∏è –î–ª—è —Ä–µ–∞–ª—å–Ω–æ—ó –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂—É. –£ –¥–µ–º–æ –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–∞ —Ü—å–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó).</p>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
          <button class="btn" id="btnCloseSub">–ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
      </div>
    </div>
  </div>

<script>
/**
 * KOLO ‚Äî –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–∏—à–µ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π (GitHub Pages‚Äë—Å—É–º—ñ—Å–Ω–∏–π) –ø—Ä–æ—Ç–æ—Ç–∏–ø.
 * ‚Äî –ü–ª–∞—Ç–µ–∂—ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ —Å–ø—Ä–∞–≤–∂–Ω—å–æ—ó –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó).
 * ‚Äî –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∑–∞–ø—Ä–æ–≤–∞–¥—å—Ç–µ –ø—Ä–æ—Å—Ç–∏–π –±–µ–∫–µ–Ω–¥ –∞–±–æ —Å–µ—Ä–≤—ñ—Å (Supabase/Firestore/Sheets) —ñ
 *   –≤–µ–±—Ö—É–∫–∏/SDK –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤ (Privat24/LiqPay/Fondy) ‚Äî –¥–∏–≤. –ø–æ–∑–Ω–∞—á–∫—É TODO.
 */

const PRIVAT_LINK = 'https://www.privat24.ua/send/3g9dp'; // –≤–∞—à –ø—É–±–ª—ñ—á–Ω–∏–π –ª—ñ–Ω–∫ –æ—Ç—Ä–∏–º—É–≤–∞—á–∞

/** –í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ: –æ–¥–Ω–∞–∫–æ–≤—ñ –¥–ª—è –≤—Å—ñ—Ö, –∑—Ä–æ—Å—Ç–∞—é—Ç—å –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–æ */
const visitorsEl = document.getElementById('visitorsNum');
const VISITORS_ANCHOR = Date.UTC(2025,8,1,0,0,0); // 2025‚Äë09‚Äë01 UTC
const VISITORS_BASE = 121369; // –ø–æ–∫–∞–∑–Ω–∏–∫ –Ω–∞ —Å—Ç–∞—Ä—Ç
function visitorsNow(){
  const now = Date.now();
  const sec = Math.floor((now - VISITORS_ANCHOR)/1000);
  // +1 –∫–æ–∂–Ω—ñ ~20 —Å–µ–∫—É–Ω–¥ (‚âà3/—Ö–≤), —Å—Ç–∞–±—ñ–ª—å–Ω–æ –¥–ª—è –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
  return VISITORS_BASE + Math.max(0, Math.floor(sec/20));
}
function tickVisitors(){ visitorsEl.textContent = visitorsNow().toLocaleString('uk-UA'); }
setInterval(tickVisitors, 5000); tickVisitors();

/** –£—Ç–∏–ª—ñ—Ç–∏ */
const $ = (sel, root=document)=>root.querySelector(sel);
const $$ = (sel, root=document)=>Array.from(root.querySelectorAll(sel));
function uuid(){ return 'ad-'+Math.random().toString(36).slice(2)+Date.now().toString(36); }
function hash32(str){ let h=2166136261>>>0; for(let i=0;i<str.length;i++){h^=str.charCodeAt(i); h=Math.imul(h,16777619);} return h>>>0; }
function rngSeeded(seed){ let a = (seed>>>0)||1; return ()=>{ a |= 0; a = a + 0x6D2B79F5 | 0; let t = Math.imul(a ^ a>>>15, 1 | a); t ^= t + Math.imul(t ^ t>>>7, 61 | t); return ((t ^ t>>>14) >>> 0) / 4294967296; } }
function fmtPrice(n){ return new Intl.NumberFormat('uk-UA').format(n) + ' –≥—Ä–Ω'; }
function daysSince(ts){ return (Date.now()-ts)/(1000*60*60*24); }

/** –õ–æ–∫–∞–ª—å–Ω–∞ ¬´–ø—ñ–¥–ø–∏—Å–∫–∞¬ª / ¬´–ø–æ—Å—Ç–∏¬ª / ¬´–¢–û–ü¬ª —Å—Ç–∞–Ω (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é) */
const LS = {
  subUntil: 'kolo_sub_until',
  postUntil: 'kolo_post_until',
  topUntil: 'kolo_top_until'
};
function getUntil(key){ const v = +localStorage.getItem(key)||0; return v; }
function setUntil(key, days){ const t = Date.now() + days*24*60*60*1000; localStorage.setItem(key, String(t)); return t; }
function isActive(key){ return getUntil(key) > Date.now(); }

/** –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó */
const CATS = [
  '–¢–æ–≤–∞—Ä–∏', '–ü–æ—Å–ª—É–≥–∏', '–†–æ–±–æ—Ç–∞', '–ê–≤—Ç–æ', '–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å', '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞', '–î—ñ–º —ñ —Å–∞–¥', '–ú–æ–¥–∞', '–•–æ–±—ñ —Ç–∞ —Å–ø–æ—Ä—Ç', '–î–∏—Ç—è—á—ñ —Ç–æ–≤–∞—Ä–∏', '–¢–≤–∞—Ä–∏–Ω–∏', '–ë—ñ–∑–Ω–µ—Å', '–Ü–Ω—à–µ'
];

/** –ü–æ—á–∞—Ç–∫–æ–≤—ñ –¥–µ–º–æ‚Äë–æ–≥–æ–ª–æ—à–µ–Ω–Ω—è (–±–µ–∑ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö) */
const DEMO = seedDemo(100);

function seedDemo(n){
  const cities = ['–û–¥–µ—Å–∞','–ö–∏—ó–≤','–õ—å–≤—ñ–≤','–î–Ω—ñ–ø—Ä–æ','–•–∞—Ä–∫—ñ–≤','–ó–∞–ø–æ—Ä—ñ–∂–∂—è','–ß–µ—Ä–Ω—ñ–≥—ñ–≤','–ü–æ–ª—Ç–∞–≤–∞','–ß–µ—Ä–Ω—ñ–≤—Ü—ñ','–¢–µ—Ä–Ω–æ–ø—ñ–ª—å','–Ü–≤–∞–Ω–æ‚Äë–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫','–ú–∏–∫–æ–ª–∞—ó–≤','–•–µ—Ä—Å–æ–Ω','–†—ñ–≤–Ω–µ','–ñ–∏—Ç–æ–º–∏—Ä','–°—É–º–∏','–í—ñ–Ω–Ω–∏—Ü—è','–£–∂–≥–æ—Ä–æ–¥','–õ—É—Ü—å–∫','–ö–∞–º º—è–Ω–µ—Ü—å‚Äë–ü–æ–¥—ñ–ª—å—Å—å–∫–∏–π'];
  const rng = rngSeeded(42);
  const pick = arr => arr[Math.floor(rng()*arr.length)];
  const words = (arr)=> pick(arr);
  const autos = ['Volkswagen Golf 1.6 TDI 2012','Toyota Corolla 1.6 2015','Skoda Octavia A7 2016','Mazda 3 2014','BMW 320d 2013','Audi A4 2012','Renault Megane 2013','Hyundai i30 2015','Kia Ceed 2016','Nissan Qashqai 2012','Ford Focus 2011','Opel Astra J 2012'];
  const electronics = ['iPhone 12 128GB','iPhone 11 64GB','Samsung Galaxy S21','Xiaomi Redmi Note 10','MacBook Air M1 8/256','Asus TUF F15 i7/16/512','Lenovo ThinkPad T480','iPad 9 gen 64GB','Sony WH‚Äë1000XM4','Canon EOS 80D'];
  const services = ['–ö–ª—ñ–Ω—ñ–Ω–≥ 24/7','–†–µ–º–æ–Ω—Ç –Ω–æ—É—Ç–±—É–∫—ñ–≤','–ú–∞–π—Å—Ç–µ—Ä –Ω–∞ –≥–æ–¥–∏–Ω—É','–í–∞–Ω—Ç–∞–∂–Ω—ñ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è','–†–µ–º–æ–Ω—Ç –∫–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä—ñ–≤','–ú–∞–Ω—ñ–∫—é—Ä / –ü–µ–¥–∏–∫—é—Ä','–ü–µ—Ä—É–∫–∞—Ä –Ω–∞ –≤–∏—ó–∑–¥','–†–µ–º–æ–Ω—Ç –ø–æ–±—É—Ç–æ–≤–æ—ó —Ç–µ—Ö–Ω—ñ–∫–∏','–®–≤–∏–¥–∫–∏–π –°–¢–û','–ú–æ–Ω—Ç–∞–∂ –¥–≤–µ—Ä–µ–π'];
  const jobs = ['–ö—É—Ä º—î—Ä –∑ –∞–≤—Ç–æ','–ú–µ–Ω–µ–¥–∂–µ—Ä –∑ –ø—Ä–æ–¥–∞–∂—É','–û–ø–µ—Ä–∞—Ç–æ—Ä call‚Äë—Ü–µ–Ω—Ç—Ä—É','–ë–∞—Ä–∏—Å—Ç–∞','–ö—É—Ö–∞—Ä','–í–æ–¥—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó B','SMM‚Äë—Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç','–ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥','–ö–∞—Å–∏—Ä','–ü—Ä–∏–±–∏—Ä–∞–ª—å–Ω–∏–∫'];
  const realty = ['1‚Äë–∫ –∫–≤–∞—Ä—Ç–∏—Ä–∞ –Ω–æ–≤–æ–±—É–¥','2‚Äë–∫ –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Ü–µ–Ω—Ç—Ä','–ë—É–¥–∏–Ω–æ–∫ –∑ –¥—ñ–ª—è–Ω–∫–æ—é','–û—Ñ—ñ—Å —É –ë–¶','–ì–∞—Ä–∞–∂ —É –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤—ñ','–î—ñ–ª—è–Ω–∫–∞ –ø—ñ–¥ –∑–∞–±—É–¥–æ–≤—É'];
  const goods = ['–î–µ—Ä–µ–≤ º—è–Ω–∏–π —Å—Ç—ñ–ª','–î–∏–≤–∞–Ω —Ä–æ–∑–∫–ª–∞–¥–Ω–∏–π','–í–µ–ª–æ—Å–∏–ø–µ–¥ MTB 29"','–î–∏—Ç—è—á–∞ –∫–æ–ª—è—Å–∫–∞','–°–ø–∞–ª—å–Ω–∏–π –º—ñ—à–æ–∫','–ì–∞–Ω—Ç–µ–ª—ñ 2√ó10 –∫–≥','–°–º–∞—Ä—Ç‚Äë–ª–∞–º–ø–∞','–ë–ª–µ–Ω–¥–µ—Ä –∫—É—Ö–æ–Ω–Ω–∏–π','–ï–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç','–ü–∏–ª–æ—Å–æ—Å —Ä–æ–±–æ—Ç'];

  function imgUrl(cat,i){
    const sig = i+1;
    if(cat==='–ê–≤—Ç–æ') return `https://source.unsplash.com/800x600/?car,vehicle&sig=${sig}`;
    if(cat==='–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å') return `https://source.unsplash.com/800x600/?apartment,interior&sig=${sig}`;
    if(cat==='–†–æ–±–æ—Ç–∞') return `https://source.unsplash.com/800x600/?office,worker&sig=${sig}`;
    if(cat==='–ü–æ—Å–ª—É–≥–∏') return `https://source.unsplash.com/800x600/?cleaning,repair,service&sig=${sig}`;
    if(cat==='–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞' || cat==='–¢–æ–≤–∞—Ä–∏') return `https://source.unsplash.com/800x600/?electronics,gadget&sig=${sig}`;
    return `https://source.unsplash.com/800x600/?shopping,product&sig=${sig}`;
  }
  function catPick(){
    const bucket = [
      '–ê–≤—Ç–æ','–ê–≤—Ç–æ','–ê–≤—Ç–æ','–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å','–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å',
      '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞','–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞','–¢–æ–≤–∞—Ä–∏','–ü–æ—Å–ª—É–≥–∏','–†–æ–±–æ—Ç–∞',
      '–î—ñ–º —ñ —Å–∞–¥','–ú–æ–¥–∞','–•–æ–±—ñ —Ç–∞ —Å–ø–æ—Ä—Ç','–î–∏—Ç—è—á—ñ —Ç–æ–≤–∞—Ä–∏','–Ü–Ω—à–µ'
    ];
    return pick(bucket);
  }
  const arr = [];
  for(let i=0;i<n;i++){
    const cat = catPick();
    const city = pick(cities);
    let title = '';
    let price = 0;
    let sub = '';
    if(cat==='–ê–≤—Ç–æ'){
      title = pick(autos);
      sub = '–õ–µ–≥–∫–æ–≤—ñ';
      price = 150000 + Math.floor(rng()*600000);
    } else if(cat==='–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å'){
      title = pick(realty);
      sub = /–∫–≤–∞—Ä—Ç–∏—Ä–∞/.test(title)?'–û—Ä–µ–Ω–¥–∞':'–ü—Ä–æ–¥–∞–∂';
      price = /–û—Ñ—ñ—Å|–∫–≤–∞—Ä—Ç–∏—Ä–∞/.test(title)?(10000+Math.floor(rng()*35000)):(450000+Math.floor(rng()*2500000));
    } else if(cat==='–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞'){
      title = pick(electronics);
      sub = '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞';
      price = 1000 + Math.floor(rng()*39000);
    } else if(cat==='–†–æ–±–æ—Ç–∞'){
      title = pick(jobs);
      sub = '–í–∞–∫–∞–Ω—Å—ñ—è';
      price = 12000 + Math.floor(rng()*48000); // –∑–∞—Ä–ø–ª–∞—Ç–∞
    } else if(cat==='–ü–æ—Å–ª—É–≥–∏'){
      title = pick(services);
      sub = '–ü–æ—Å–ª—É–≥–∏';
      price = 300 + Math.floor(rng()*4700);
    } else if(cat==='–¢–æ–≤–∞—Ä–∏'){
      title = pick(goods);
      sub = '–¢–æ–≤–∞—Ä–∏';
      price = 200 + Math.floor(rng()*19800);
    } else {
      title = words(['–ü—Ä–æ–¥–∞–º','–ö—É–ø–ª—é','–û–±–º—ñ–Ω—è—é'][Math.floor(rng()*3)]) + ' ' + words(['—Ä—ñ—á','–Ω–∞–±—ñ—Ä','–∞–∫—Å–µ—Å—É–∞—Ä']);
      sub = '–Ü–Ω—à–µ';
      price = 100 + Math.floor(rng()*5000);
    }
    const created = Date.now() - Math.floor(rng()*30*24*60*60*1000) - Math.floor(rng()*60*60*1000);
    const imgs = [imgUrl(cat,i), imgUrl(cat,i+100), imgUrl(cat,i+200)];
    const topActive = i < 12; // –ø–µ—Ä—à—ñ 12 ‚Äî —É TOP
    arr.push({
      id: uuid(),
      cat, sub, city, title,
      price, desc: `${title}. ${city}. –í—ñ–¥–º—ñ–Ω–Ω–∏–π —Å—Ç–∞–Ω / —á–µ—Å–Ω–∏–π –æ–ø–∏—Å. –ú–æ–∂–ª–∏–≤–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –∞–±–æ —Å–∞–º–æ–≤–∏–≤—ñ–∑.`,
      phone: '–î–ï–ú–û: +380 00 000 00 00',
      imgs, created,
      topUntil: topActive ? (Date.now() + (1+Math.floor(rng()*6))*24*60*60*1000) : 0
    });
  }
  return arr;
}

/** –ó–±–µ—Ä–µ–∂–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è */
function loadMyAds(){ try { return JSON.parse(localStorage.getItem('kolo_ads')||'[]'); } catch(e){ return []; } }
function saveMyAds(list){ localStorage.setItem('kolo_ads', JSON.stringify(list)); }

/** –í–∏—Ä–∞—Ö—É–≤–∞–Ω—ñ –ø–µ—Ä–µ–≥–ª—è–¥–∏: –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω—ñ –¥–ª—è –≤—Å—ñ—Ö (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞) */
const VIEWS_ANCHOR = Date.UTC(2025,8,1,0,0,0); // 2025‚Äë09‚Äë01
function calcViews(ad){
  const seed = hash32(ad.id + ad.title);
  const rng = rngSeeded(seed);
  const base = 300 + Math.floor(rng()*900); // 300..1199
  const mins = Math.max(0, Math.floor((Date.now()-VIEWS_ANCHOR)/60000));
  const perMin = 0.35 + rng()*0.7; // 0.35..1.05 / —Ö–≤
  return base + Math.floor(mins * perMin);
}

/** –§—ñ–ª—å—Ç—Ä–∏ */
const filterCategory = $('#filterCategory');
const filterCity = $('#filterCity');
const filterQ = $('#filterQ');
const filterSort = $('#filterSort');
function fillCategories(){
  filterCategory.innerHTML = '<option value="">–£—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>' + CATS.map(c=>`<option>${c}</option>`).join('');
  $('#fCat').innerHTML = CATS.map(c=>`<option>${c}</option>`).join('');
}

/** –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ–∫ */
const grid = $('#grid');
const topRow = $('#topRow');
let TAB = 'all';
function getAllAds(){
  const my = loadMyAds();
  return [...my, ...DEMO];
}
function isTop(ad){ return ad.topUntil && ad.topUntil > Date.now(); }
function matchesTab(ad){
  if(TAB==='all') return true;
  if(TAB==='jobs') return ad.cat==='–†–æ–±–æ—Ç–∞';
  if(TAB==='services') return ad.cat==='–ü–æ—Å–ª—É–≥–∏';
  if(TAB==='goods') return ad.cat==='–¢–æ–≤–∞—Ä–∏' || ad.cat==='–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞' || ad.cat==='–î—ñ–º —ñ —Å–∞–¥' || ad.cat==='–ú–æ–¥–∞' || ad.cat==='–•–æ–±—ñ —Ç–∞ —Å–ø–æ—Ä—Ç' || ad.cat==='–î–∏—Ç—è—á—ñ —Ç–æ–≤–∞—Ä–∏';
  if(TAB==='realty') return ad.cat==='–ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å';
  if(TAB==='auto') return ad.cat==='–ê–≤—Ç–æ';
  return true;
}
function render(){
  const q = filterQ.value.trim().toLowerCase();
  const cat = filterCategory.value;
  const city = filterCity.value.trim().toLowerCase();
  let list = getAllAds().filter(a=>matchesTab(a));
  if(cat) list = list.filter(a=>a.cat===cat);
  if(city) list = list.filter(a=>a.city.toLowerCase().includes(city));
  if(q) list = list.filter(a=> (a.title+' '+a.desc+' '+a.sub).toLowerCase().includes(q));
  // sort
  if(filterSort.value==='new') list.sort((a,b)=>b.created-a.created);
  else if(filterSort.value==='cheap') list.sort((a,b)=>a.price-b.price);
  else if(filterSort.value==='exp') list.sort((a,b)=>b.price-a.price);
  else if(filterSort.value==='views') list.sort((a,b)=>calcViews(b)-calcViews(a));

  // TOP row
  const tops = list.filter(isTop).slice(0,24);
  topRow.innerHTML = tops.map(cardHTML).join('') || '<div class="muted">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î TOP –æ–≥–æ–ª–æ—à–µ–Ω—å.</div>';

  // grid
  grid.innerHTML = list.map(cardHTML).join('') || '<div class="muted">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –ó–º—ñ–Ω—ñ—Ç—å —Ñ—ñ–ª—å—Ç—Ä–∏.</div>';
  // attach actions
  $$('.btnShowPhone').forEach(btn=>btn.addEventListener('click', ()=>showPhone(btn.dataset.id)));
}
function cardHTML(ad){
  const img = (ad.imgs && ad.imgs[0]) || '';
  const v = calcViews(ad);
  return `<div class="card">
    <div class="thumb">${img?`<img src="${img}" alt="${escapeHtml(ad.title)}" loading="lazy">`:''}
      ${isTop(ad)?`<span class="badge-top pill">TOP</span>`:''}
    </div>
    <div class="body">
      <div class="title-2">${escapeHtml(ad.title)}</div>
      <div class="meta">
        <span>${escapeHtml(ad.city)}</span>
        <span>‚Ä¢</span>
        <span class="muted">${escapeHtml(ad.sub||ad.cat)}</span>
      </div>
      <div class="price">${fmtPrice(ad.price)}</div>
      <div class="meta"><span title="–ü–µ—Ä–µ–≥–ª—è–¥–∏ —Ü—å–æ–≥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è">üëÅÔ∏è ${v.toLocaleString('uk-UA')}</span></div>
      <div class="actions">
        <button class="btn brand btnShowPhone" data-id="${ad.id}">–ü–æ–∫–∞–∑–∞—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω</button>
      </div>
    </div>
  </div>`;
}
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m])); }

/** –ü–æ–∫–∞–∑ –Ω–æ–º–µ—Ä–∞ */
const overlaySub = $('#overlaySub');
$('#btnCloseSub').addEventListener('click', ()=>overlaySub.classList.remove('on'));
$('#pay29').href = PRIVAT_LINK + '?amount=29';
$('#btnPaid29').addEventListener('click', ()=>{ setUntil(LS.subUntil, 30); overlaySub.classList.remove('on'); alert('–ü—ñ–¥–ø–∏—Å–∫—É –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –Ω–∞ 30 –¥–Ω—ñ–≤ (–ª–æ–∫–∞–ª—å–Ω–æ).'); });

function showPhone(id){
  if(!isActive(LS.subUntil)) { overlaySub.classList.add('on'); return; }
  // reveal phone in a toast
  const ad = getAllAds().find(a=>a.id===id);
  if(!ad) return;
  const phone = ad.phone || '+380';
  alert('–¢–µ–ª–µ—Ñ–æ–Ω –ø—Ä–æ–¥–∞–≤—Ü—è: ' + phone + '\n–ú–æ–∂–µ—Ç–µ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ OK —Ç–∞ –∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏.');
}

/** –î–æ–¥–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è (–≥–µ–π—Ç 40 –≥—Ä–Ω, TOP ‚Äî 299) */
const overlayAdd = $('#overlayAdd');
const formAdd = $('#formAdd');
const addGate = $('#addGate');
$('#btnAdd').addEventListener('click', ()=>{
  overlayAdd.classList.add('on');
  updateAddGate();
});
$('#btnCloseAdd').addEventListener('click', ()=>overlayAdd.classList.remove('on'));
$('#pay40').href = PRIVAT_LINK + '?amount=40';
$('#btnPaid40').addEventListener('click', ()=>{ setUntil(LS.postUntil, 30); updateAddGate(); alert('–î–æ—Å—Ç—É–ø –¥–æ —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –Ω–∞ 30 –¥–Ω—ñ–≤ (–ª–æ–∫–∞–ª—å–Ω–æ).'); });
$('#pay299').href = PRIVAT_LINK + '?amount=299';
$('#btnPaid299').addEventListener('click', ()=>{ setUntil(LS.topUntil, 7); alert('TOP –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –Ω–∞ 7 –¥–Ω—ñ–≤ (–ª–æ–∫–∞–ª—å–Ω–æ).'); });

function updateAddGate(){
  const canPost = isActive(LS.postUntil);
  addGate.style.display = canPost ? 'none' : 'block';
  formAdd.style.display = canPost ? 'block' : 'none';
  $('#topPayRow').style.display = $('#fTop').checked ? 'flex' : 'none';
}
$('#fTop').addEventListener('change', updateAddGate);

/** –ü—Ä–µ–≤‚Äô—é –∑–æ–±—Ä–∞–∂–µ–Ω—å */
$('#fImages').addEventListener('change', (e)=>{
  const box = $('#fPreviews');
  box.innerHTML = '';
  const files = Array.from(e.target.files||[]).slice(0,6);
  for(const f of files){
    const img = document.createElement('img');
    img.style.width='64px'; img.style.height='64px'; img.style.objectFit='cover'; img.style.borderRadius='8px';
    box.appendChild(img);
    const fr = new FileReader(); fr.onload = ()=> img.src = fr.result; fr.readAsDataURL(f);
  }
});

/** Submit */
formAdd.addEventListener('submit', (e)=>{
  e.preventDefault();
  const canPost = isActive(LS.postUntil);
  if(!canPost){ alert('–ü–æ—Ç—Ä—ñ–±–Ω–∞ –æ–ø–ª–∞—Ç–∞ 40 –≥—Ä–Ω –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è.'); return; }
  const topWanted = $('#fTop').checked;
  const topOK = !topWanted || isActive(LS.topUntil);
  if(topWanted && !topOK){ alert('–î–ª—è TOP –ø–æ—Ç—Ä—ñ–±–Ω–∞ –æ–ø–ª–∞—Ç–∞ 299 –≥—Ä–Ω.'); return; }

  const files = Array.from($('#fImages').files||[]).slice(0,6);
  const imgsP = Promise.all(files.map(f=> new Promise(res=>{ const fr = new FileReader(); fr.onload = ()=>res(fr.result); fr.readAsDataURL(f); })));
  imgsP.then(imgs=>{
    const ad = {
      id: uuid(),
      cat: $('#fCat').value,
      sub: $('#fSub').value.trim(),
      city: $('#fCity').value.trim(),
      title: $('#fTitle').value.trim(),
      price: Math.max(0, +$('#fPrice').value||0),
      desc: $('#fDesc').value.trim(),
      phone: $('#fPhone').value.trim(),
      imgs,
      created: Date.now(),
      topUntil: (topWanted && isActive(LS.topUntil)) ? getUntil(LS.topUntil) : 0
    };
    const mine = loadMyAds(); mine.unshift(ad); saveMyAds(mine);
    overlayAdd.classList.remove('on');
    clearAddForm();
    render();
    alert('–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Ü—å–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó. –î–ª—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –ø–æ—Ç—Ä—ñ–±–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Ö–º–∞—Ä–Ω–æ–≥–æ —Å—Ö–æ–≤–∏—â–∞/—Å–µ—Ä–≤–µ—Ä—É (–¥–∏–≤. TODO –≤ –∫–æ–¥—ñ).');
  });
});

function clearAddForm(){
  $('#fSub').value = $('#fCity').value = $('#fTitle').value = $('#fDesc').value = $('#fPhone').value = '';
  $('#fPrice').value = '';
  $('#fImages').value = '';
  $('#fPreviews').innerHTML = '';
  $('#fTop').checked = false; updateAddGate();
}

/** Tabs */
$('#tabs').addEventListener('click', (e)=>{
  const t = e.target.closest('.tab'); if(!t) return;
  $$('.tab').forEach(x=>x.classList.toggle('active', x===t));
  TAB = t.dataset.tab;
  render();
});

/** –Ü–Ω–ø—É—Ç —Å–ª—É—Ö–∞—á—ñ */
[filterCategory, filterCity, filterQ, filterSort].forEach(el=>el.addEventListener('input', render));

/** –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è */
fillCategories();
render();
setInterval(()=>{ // –ª–µ–≥–∫–µ –ø—ñ–¥–∫—Ä—É—á—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤
  $$('.card .meta').forEach((_,i)=>{}); // —Ç—Ä–∏–≥–µ—Ä —Ä–µ—Ä–µ–Ω–¥–µ—Ä—É
  render();
}, 20000);

/**
 * TODO (–¥–ª—è –±–æ–π–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫—É, –±–µ–∑ –∑–º—ñ–Ω–∏ UI):
 * 1) StorageAdapter:
 *    - –†–µ–∞–ª—ñ–∑—É–π—Ç–µ –∑–∞–º—ñ–Ω—É loadMyAds/saveMyAds –Ω–∞ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ —Ö–º–∞—Ä–∏ (Supabase/Firestore/Sheets API).
 *      –£ –∫–æ–∂–Ω–æ–≥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è: id, –ø–æ–ª—è —è–∫ —É –º–æ–¥–µ–ª—ñ, topUntil, created.
 * 2) Payment webhooks:
 *    - –ü—ñ—Å–ª—è –∫–ª—ñ–∫—É ¬´–û–ø–ª–∞—Ç–∏—Ç–∏¬ª –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤–∞—à–æ–≥–æ –±–µ–∫–µ–Ω–¥—É, —è–∫–∞ –≥–µ–Ω–µ—Ä—É—î –ø–ª–∞—Ç—ñ–∂ —ñ –º–∞—î callback.
 *      –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂—É –±–µ–∫–µ–Ω–¥ –≤–∏—Å—Ç–∞–≤–ª—è—î —É —Å—Ö–æ–≤–∏—â—ñ:
 *        userId (–∞–Ω–æ–Ω—ñ–º–Ω–∏–π —Ç–æ–∫–µ–Ω/–∫—É–∫–∞) ‚Üí subUntil/postUntil/topUntil.
 *    - –ù–∞ —Ñ—Ä–æ–Ω—Ç—ñ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ –æ–ø–∏—Ç—É–π—Ç–µ /me/status —ñ –≤–º–∏–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –±–µ–∑ ¬´–ª–æ–∫–∞–ª—å–Ω–æ—ó¬ª –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó.
 */
</script>
</body>
</html>

