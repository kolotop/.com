<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>KOLO — барахолка оголошень</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no"/>
  <meta name="format-detection" content="telephone=no"/>
  <meta name="theme-color" content="#10b981"/>

  <!-- Share preview -->
  <meta property="og:title" content="KOLO — барахолка оголошень">
  <meta property="og:description" content="KOLO: додай оголошення за хвилину. Фільтри, HOT-ТОП, галерея, лайки та перегляди.">
  <meta property="og:image" content="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='630'><rect width='100%' height='100%' fill='%2310b981'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Arial Black,Arial' font-size='96' fill='white'>KOLO</text></svg>">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect rx='14' ry='14' width='64' height='64' fill='%2310b981'/><circle cx='32' cy='32' r='14' fill='white'/></svg>">

  <link href="https://fonts.googleapis.com/css2?family=Russo+One&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6fbf8;
      --paper:#ffffff; --ink:#0f172a;
      --muted:#64748b;
      --brand:#0ea371; --brand-press:#0c8f63;
      --line:#d6e8de;
      --field-bg:#edf7f1; --field-br:#cfe8da;
      --ph:#7aa896;
      --menu-bg:#ffffff; --menu-br:#cfe8da; --menu-hover:#eefaf3;
      --top:60px;
      --hotGrad: linear-gradient(90deg,#ff8a80,#ffc1bd); /* більш червоний */
      --thumb-ph:#e7f4ee;
      --shadow-sm: 0 4px 12px rgba(2, 44, 34, .08);
      --shadow-lg: 0 14px 40px rgba(2, 44, 34, .14);
    }
    *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--ink); font-family:"Montserrat",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;}
    body.modal-open{overflow:hidden}

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:100;
      height:var(--top); display:flex; align-items:center; gap:10px;
      padding:10px 12px; background:#ffffffcc; backdrop-filter:saturate(140%) blur(6px);
      border-bottom:1px solid var(--line);
    }
    .logo{background:var(--brand); color:#fff; border-radius:12px; padding:8px 12px; font:700 16px/1 "Russo One",sans-serif; box-shadow:var(--shadow-sm)}
    .pill{display:inline-flex; align-items:center; gap:8px; height:38px; padding:0 12px; border-radius:12px; border:1px solid var(--line); background:#fff; cursor:pointer; font-weight:700; color:var(--ink)}
    .pill.green{background:var(--brand); color:#fff; border-color:transparent; font-family:"Russo One"; text-transform:uppercase; box-shadow:var(--shadow-sm); text-shadow:0 1px 0 rgba(0,0,0,.35)}
    .pill.green:active{transform:translateY(1px); background:var(--brand-press)}
    .grow{flex:1}

    .container{max-width:1200px; margin:12px auto; padding:0 12px;}
    .panel{background:var(--paper); border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-sm);}

    /* HOT strip */
    .hotWrap{margin:12px 0 6px}
    .hotHead{display:flex; align-items:center; gap:12px; margin-bottom:8px; color:#0e3a2a}
    .hotHead .tag{background:var(--hotGrad); padding:8px 12px; border-radius:12px; font:700 14px/1 "Russo One"; color:#3a2f2f}
    .hotGrid{display:grid; grid-template-columns:repeat(5,1fr); gap:10px}
    @media (max-width:1024px){ .hotGrid{grid-template-columns:repeat(3,1fr);} }
    @media (max-width:640px){ .hotGrid{grid-template-columns:repeat(2,1fr);} }
    .hotCard{position:relative; border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff; cursor:pointer; box-shadow:var(--shadow-sm)}
    .hotCard .thumb{position:relative; padding-top:56%; background:var(--thumb-ph)}
    .hotBadge{position:absolute; left:8px; top:8px; background:var(--hotGrad); padding:4px 8px; border-radius:10px; font:700 12px/1 "Russo One"; color:#3a2f2f; border:1px solid #ffe0dc; z-index:2}
    .hotPrice{position:absolute; left:8px; bottom:8px; background:var(--brand); color:#fff; border:0; padding:6px 10px; border-radius:10px; font-weight:800; font-size:12px; z-index:2}
    .hotBody{padding:8px; font-size:13px}
    .hotTTL{font:700 14px/1.2 "Russo One"; color:#0f172a}
    .hotSplit{height:1px; background:var(--line); margin:14px 0 6px; border-radius:1px}

    /* Grid */
    .topline{display:flex; align-items:center; gap:10px; margin:14px 0;}
    .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:12px;}
    @media (max-width:1024px){ .grid{grid-template-columns:repeat(2,1fr);} }
    @media (max-width:640px){ .grid{grid-template-columns:1fr;} }

    .card{ background:#fff; border:1px solid var(--line); border-radius:14px; overflow:hidden; display:flex; flex-direction:column; cursor:pointer; transition:box-shadow .08s ease; box-shadow:var(--shadow-sm)}
    /* прибрав transform, щоб сторінка не "сіпалась" при кліку */
    .card:active{box-shadow:var(--shadow-lg)}
    .thumb{position:relative; padding-top:62%; background:var(--thumb-ph); overflow:hidden;}
    .thumb img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover;}
    .badge{position:absolute; left:8px; top:8px; background:var(--brand); color:#fff; border-radius:10px; padding:6px 10px; font:800 14px/1 "Russo One"; z-index:2}
    .views{position:absolute; right:8px; bottom:8px; background:#0f172a; color:#fff; border:0; border-radius:10px; padding:5px 8px; font-weight:700; font-size:12px}
    .likeBtn{
      position:absolute; right:8px; top:8px; height:38px; min-width:48px; padding:0 10px;
      border-radius:12px; border:0; background:var(--brand); color:#fff; font:900 16px/38px 'Russo One',sans-serif;
      cursor:pointer; box-shadow:var(--shadow-sm); outline:none; z-index:2
    }
    .likeBtn span{font-weight:800; margin-left:6px}
    .body{padding:10px; display:flex; flex-direction:column; gap:6px}
    .title{font:700 16px/1.2 "Russo One"; letter-spacing:.4px; color:#0f172a}

    /* Detail modal */
    .detail{position:fixed; inset:0; z-index:120; display:none; background:rgba(0,0,0,.35);}
    .detail.active{display:block;}
    .sheet{position:absolute; left:50%; top:6vh; transform:translateX(-50%); width:min(1080px,96vw); max-height:88vh; overflow:auto; background:#fff; border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-lg);}
    .modalHead{display:flex; align-items:center; gap:10px; margin-bottom:8px}

    /* Gallery */
    .big{position:relative; padding-top:56%; background:var(--thumb-ph); border-radius:12px; overflow:hidden}
    .big img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    .navBtn{
      position:absolute; top:50%; transform:translateY(-50%);
      height:48px; min-width:48px; padding:0 12px;
      border-radius:14px; border:1px solid var(--line);
      background:#ffffffdd;
      color:#065f46; font-weight:900; font-size:26px; line-height:46px;
      cursor:pointer; box-shadow:var(--shadow-sm);
      backdrop-filter:saturate(110%) blur(3px);
    }
    .navPrev{left:8px} .navNext{right:8px}

    .specs{display:grid; grid-template-columns:repeat(4,1fr); gap:8px}
    @media (max-width:900px){ .specs{grid-template-columns:repeat(2,1fr);} }
    .spec{background:#f4fbf7; border:1px solid var(--line); border-radius:12px; padding:8px; font-size:13px}
    .h{font:700 14px/1 "Russo One"; margin-bottom:6px; color:#0b3b2d}
    .divider{height:1px; background:var(--line); margin:10px 0}
    .seller{display:flex; gap:10px; align-items:center}
    .avatar{width:44px; height:44px; border-radius:50%; background:#dff3ea; color:#065f46; display:flex; align-items:center; justify-content:center; font-weight:800}

    .pager{display:flex; justify-content:center; margin:16px 0 40px}
    #dAttribution{display:none}

    /* SELL & SEARCH modal */
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:150}
    .overlay.on{display:flex}
    .modal{width:min(960px,96vw); max-height:88vh; overflow:auto; background:#fff; border:1px solid var(--line); border-radius:16px; padding:12px; box-shadow:var(--shadow-lg);}
    .closeX{height:38px; border:1px solid var(--line); background:#fff; color:#0f172a; border-radius:12px; font:700 13px/38px 'Russo One'; padding:0 12px; cursor:pointer}

    .filters{display:grid; grid-template-columns:repeat(6,1fr); gap:10px;}
    @media (max-width:1024px){ .filters{grid-template-columns:repeat(3,1fr);} }
    @media (max-width:640px){ .filters{grid-template-columns:1fr 1fr;} }
    label{font-size:12px; font-weight:800; opacity:.92; display:block; margin:0 0 6px; color:#0b3b2d}
    .input,.select{ width:100%; height:46px; border-radius:12px; border:1px solid var(--field-br); background:var(--field-bg); color:#064e3b; padding:0 12px; font-size:14px; outline:none; }
    .input::placeholder{color:var(--ph)}
    textarea.input{color:#0f172a}
    .actions{display:flex; gap:10px; margin-top:10px; flex-wrap:wrap}
    .btn{height:48px; border:none; border-radius:14px; background:var(--brand); color:#fff; font:700 16px/48px "Russo One"; padding:0 18px; cursor:pointer; box-shadow:var(--shadow-sm); text-shadow:0 1px 0 rgba(0,0,0,.35)}
    .btn:active{transform:translateY(2px); background:var(--brand-press)}
    .btn.ghost{background:#fff; color:#0f172a; border:1px solid var(--line); box-shadow:none; text-shadow:none}

    /* Nice Select (desktop) */
    @media (hover:hover){
      .select.nice-hidden{position:absolute; inset:0; opacity:0; pointer-events:none}
      .nice{position:relative}
      .nice-btn{ width:100%; height:46px; border-radius:12px; border:1px solid var(--field-br); background:var(--field-bg); color:#064e3b; padding:0 38px 0 12px; text-align:left; font-size:14px; font-weight:600; cursor:pointer; }
      .nice-btn:after{content:"▾"; position:absolute; right:12px; top:50%; transform:translateY(-50%); opacity:.8; pointer-events:none}
      .nice-list{ position:fixed; left:0; top:0; width:260px; background:var(--menu-bg); border:1px solid var(--menu-br); border-radius:12px; padding:6px; box-shadow:var(--shadow-lg); display:none; max-height:300px; overflow:auto; z-index:2147483647; }
      .nice-item{padding:10px 12px; border-radius:10px; cursor:pointer; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
      .nice-item:hover{background:var(--menu-hover)}
      .nice-item.active{background:#e7f7ef}
    }

    /* ===== Preloader ===== */
    .preloader{position:fixed; inset:0; background:#ffffff; display:flex; align-items:center; justify-content:center; z-index:9999}
    .pl-wrap{position:relative; width:220px; height:220px; display:grid; place-items:center}
    .pl-ring{
      position:absolute; inset:0; border-radius:50%;
      border:10px solid #e7f4ee; border-top-color:#10b981; animation:spin 1.2s linear infinite;
    }
    .pl-logo{font:700 42px "Russo One"; color:#10b981; letter-spacing:2px}
    .pl-txt{position:absolute; bottom:18px; font-weight:700; color:#065f46}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <!-- PRELOADER 5 сек -->
  <div id="preloader" class="preloader" aria-hidden="false">
    <div class="pl-wrap">
      <div class="pl-ring"></div>
      <div class="pl-logo">KOLO</div>
      <div class="pl-txt">Завантаження…</div>
    </div>
  </div>

  <header class="topbar">
    <div class="logo">KOLO</div>
    <div class="pill" id="tabSearch">Пошук</div>
    <div class="grow"></div>
    <div class="pill green" id="tabSell">Додати оголошення</div>
  </header>

  <main class="container">
    <!-- HOT -->
    <section class="panel hotWrap" id="hotPanel" style="display:none">
      <div class="hotHead">
        <div class="tag">🔥 HOT — ТОП-10</div>
        <!-- примітка прибрано за вимогою -->
      </div>
      <div class="hotGrid" id="hotGrid"></div>
    </section>
    <div class="hotSplit" id="hotSplit" style="display:none"></div>

    <!-- РЕЗУЛЬТАТИ -->
    <section class="topline">
      <div id="resCount" style="display:none">0</div> <!-- лічильник прихований -->
      <div class="grow"></div>
    </section>
    <section class="grid" id="grid"></section>
    <div class="pager"><button class="btn" id="btnMore" style="display:none">Показати ще</button></div>
  </main>

  <!-- DETAIL -->
  <div id="detail" class="detail" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="modalHead">
        <div class="logo">KOLO</div>
        <div class="grow"></div>
        <!-- одна зелена кнопка лайка з лічильником -->
        <button title="Лайк" aria-label="Лайк" class="pill green" id="dLike" style="display:inline-flex;gap:8px">♥ <span id="dLikeCnt">0</span></button>
        <button class="closeX" id="dClose">Закрити</button>
      </div>
      <div id="dHeader" style="display:flex; align-items:center; gap:10px; margin-bottom:8px"></div>
      <div id="dGal"></div>
      <div class="divider"></div>
      <div class="specs" id="dSpecs"></div>
      <div class="divider"></div>
      <div id="dDesc" style="opacity:.9"></div>
      <div class="divider"></div>
      <div class="seller" id="dSeller"></div>
      <div id="dAttribution" style="margin-top:8px; font-size:12px; opacity:.8"></div>
    </div>
  </div>

  <!-- SELL MODAL -->
  <div class="overlay" id="sellOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="sellTitle">
      <div class="modalHead">
        <h3 id="sellTitle" style="margin:0; font:700 18px/1 'Russo One'; color:#0f172a">Додати оголошення</h3>
        <div class="grow"></div>
        <button class="closeX" id="sellClose">Закрити</button>
      </div>
      <div class="filters" style="grid-template-columns:repeat(3,1fr)">
        <div><label>Місто / Село</label><input class="input" id="sCity" placeholder="Напр., Київ • Дарницький" list="cityList" autocomplete="off"></div>
        <div><label>Категорія</label><select class="select" id="sCat"></select></div>
        <div><label>Стан</label><select class="select" id="sCond"></select></div>

        <div style="grid-column:1/-1"><label>Заголовок</label><input class="input" id="sTitle" placeholder="Напр., iPhone 13, 128GB, стан 9/10"></div>

        <div><label>Тип продавця</label><select class="select" id="sSeller"></select></div>
        <div><label>Ціна, ₴</label><input class="input" id="sPrice" placeholder="15000"></div>
        <div><label>Телефон (публічний)</label><input class="input" id="sPhone" placeholder="+380 (..) ...-..-.."></div>

        <div style="grid-column:1/-1"><label>Опис</label><textarea class="input" id="sDesc" rows="3" style="height:auto; padding:10px" placeholder="Стан, комплектація, самовивіз/доставка... (мін. 20 символів)"></textarea></div>
        <div style="grid-column:1/-1"><label>URL фото (через |)</label><input class="input" id="sImages" placeholder="https://...jpg|https://...jpg"></div>
        <datalist id="cityList"></datalist>
      </div>
      <div class="actions">
        <button class="btn" id="sSave">Опублікувати</button>
        <div style="opacity:.7;font-size:12px;color:#0b3b2d">Антиспам: 1 оголошення / 60 сек.</div>
      </div>
    </div>
  </div>

  <!-- SEARCH MODAL -->
  <div class="overlay" id="searchOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="searchTitle">
      <div class="modalHead">
        <h3 id="searchTitle" style="margin:0; font:700 18px/1 'Russo One'; color:#0f172a">Пошук</h3>
        <div class="grow"></div>
        <button class="closeX" id="searchClose">Закрити</button>
      </div>
      <div class="filters" id="filters">
        <div>
          <label>Місто / Область / Село</label>
          <input class="input" id="fltCity" placeholder="Почніть вводити…" list="cityList" autocomplete="off">
        </div>
        <div><label>Категорія</label><select class="select" id="fltCat" data-placeholder="Категорія"></select></div>
        <div><label>Стан</label><select class="select" id="fltCond" data-placeholder="Стан"></select></div>
        <div><label>Тип продавця</label><select class="select" id="fltSeller" data-placeholder="Тип"></select></div>
        <div><label>Ціна від, ₴</label><input class="input" id="fltPriceMin" placeholder="0"></div>
        <div><label>Ціна до, ₴</label><input class="input" id="fltPriceMax" placeholder="∞"></div>
        <div style="grid-column:1/-1"><label>Пошук</label><input class="input" id="fltQuery" placeholder="Назва, бренд, ключові слова"></div>
        <div class="check"><input type="checkbox" id="fltRecent"> <label for="fltRecent">За 30 днів</label></div>
        <div style="grid-column:1/-1; display:flex; gap:10px; align-items:center">
          <button class="btn" id="btnApply">Знайти</button>
          <button class="btn ghost" id="btnReset">Скинути</button>
          <select class="select" id="sortBy" style="max-width:260px">
            <option value="new">Сортувати: нові</option>
            <option value="priceAsc">Ціна ↑</option>
            <option value="priceDesc">Ціна ↓</option>
            <option value="likesDesc">Лайки ↓</option>
            <option value="viewsDesc">Перегляди ↓</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <script>
  const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);
  const DB_KEY = "kolo_listings_v2";
  const CTRL_KEY = "kolo_ctrl_v2";

  /* ===== Україна: регіони + базові міста (fallback) =====
     Повний довідник (усі міста/села) завантажується з файлу ua-places.min.json (покладіть поруч із HTML).
     Формат файлу: масив об'єктів { "region":"Одеська", "name":"Сарата" } */
  const UA_REGIONS = {
    "Київська":["Київ","Біла Церква","Бровари","Бориспіль","Ірпінь","Буча"],
    "Львівська":["Львів","Дрогобич","Червоноград","Стрий"],
    "Одеська":["Одеса","Чорноморськ","Южне","Ізмаїл","Білгород-Дністровський"],
    "Харківська":["Харків","Лозова","Ізюм"],
    "Дніпропетровська":["Дніпро","Кривий Ріг","Кам'янське","Нікополь","Павлоград"],
    "Запорізька":["Запоріжжя","Мелітополь","Бердянськ"],
    "Миколаївська":["Миколаїв","Первомайськ","Южноукраїнськ"],
    "Херсонська":["Херсон","Нова Каховка","Каховка"],
    "Вінницька":["Вінниця","Жмеринка","Могилів-Подільський"],
    "Полтавська":["Полтава","Кременчук","Миргород"],
    "Черкаська":["Черкаси","Умань","Сміла"],
    "Чернігівська":["Чернігів","Ніжин","Прилуки"],
    "Сумська":["Суми","Шостка","Конотоп","Охтирка"],
    "Житомирська":["Житомир","Бердичів","Коростень"],
    "Хмельницька":["Хмельницький","Кам'янець-Подільський","Шепетівка"],
    "Чернівецька":["Чернівці","Хотин"],
    "Рівненська":["Рівне","Дубно","Вараш"],
    "Івано-Франківська":["Івано-Франківськ","Калуш","Коломия","Яремче"],
    "Тернопільська":["Тернопіль","Чортків","Кременець"],
    "Волинська":["Луцьк","Ковель","Володимир"],
    "Закарпатська":["Ужгород","Мукачево","Хуст"],
    "Кіровоградська":["Кропивницький","Олександрія","Світловодськ"]
  };
  let PLACES = Object.keys(UA_REGIONS).flatMap(r => UA_REGIONS[r].map(n => ({region:r, name:n})));

  /* ===== Категорії (без підкатегорій, розширений список) ===== */
  const ALL_CATS = [
    "Транспорт","Запчастини та аксесуари","Нерухомість","Електроніка",
    "Дім і сад","Меблі","Побутова техніка","Будівництво та ремонт",
    "Спорт і Хобі","Велосипеди","Туризм","Музичні інструменти",
    "Мода та стиль","Одяг","Взуття","Аксесуари",
    "Дитячий світ","Іграшки","Візочки","Одяг для дітей",
    "Тварини","Коти","Собаки","Зоотовари",
    "Послуги","Ремонт","Доставка","Фото/Відео","Освіта","Логістика",
    "Робота","Вакансії","Підробіток","Віддалено",
    "Бізнес та обладнання","Сільське господарство","Краса та здоров’я"
  ];
  const CONDS=["Нове","Вживане","Після ремонту"];
  const SELLERS=["Приватний","Бізнес"];

  /* ===== Фото ===== */
  const IMG = {
    car:[
      "https://upload.wikimedia.org/wikipedia/commons/8/8e/2017_Skoda_Octavia_SE_TDi_1.6_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/6/65/2018_Toyota_Camry_LE_front_6.22.18.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/b/b1/2018_BMW_320d_M_Sport_Automatic_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/e/ea/2018_Audi_A4_Sport_TDi_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/2/26/2018_Volkswagen_Golf_SE_NAV_TDi_1.6_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/1/1e/2018_Volvo_XC60_Momentum_D4_AWD_2.0_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/7/7f/2018_Kia_Sportage_3_CRDi_ISG_1.7_Front.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/4/4e/2017_Hyundai_Tucson_Premium_SE_2.0.jpg"
    ],
    moto:[
      "https://upload.wikimedia.org/wikipedia/commons/1/19/Honda_CB500F.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/0/0b/Yamaha_YZF-R6.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/7/7a/Kawasaki_Ninja_650.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/8/88/Suzuki_SV650S_2003.jpg"
    ],
    phone:[
      "https://upload.wikimedia.org/wikipedia/commons/9/94/Samsung_Galaxy_S21_5G.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/1/17/Google_Pixel_6_-_Retail_Package.jpg",
      "https://upload.wikimedia.org/wikipedia/commons/3/3c/IPhone_13_Pro_Max_Alpine_Green.png"
    ],
    laptop:[
      "https://upload.wikimedia.org/wikipedia/commons/4/40/MacBook_Pro_16-inch.png",
      "https://upload.wikimedia.org/wikipedia/commons/4/45/Lenovo_ThinkPad_T440s.jpg"
    ],
    tv:[ "https://upload.wikimedia.org/wikipedia/commons/6/60/Modern_TV.jpg" ],
    washer:[ "https://upload.wikimedia.org/wikipedia/commons/5/5f/Washing_machine_bosch.jpg" ],
    sofa:[ "https://upload.wikimedia.org/wikipedia/commons/1/1d/Sofa_in_living_room.jpg" ],
    bike:[ "https://upload.wikimedia.org/wikipedia/commons/7/7b/Road_bicycle.jpg" ],
    dog:[ "https://upload.wikimedia.org/wikipedia/commons/6/6e/Golde33443.jpg" ],
    cat:[ "https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg" ],
    flat:[ "https://upload.wikimedia.org/wikipedia/commons/2/22/Minimalist_apartment_interior.jpg" ],
    tools:[ "https://upload.wikimedia.org/wikipedia/commons/2/2f/Hand_tools.jpg" ],
    decor:[ "https://upload.wikimedia.org/wikipedia/commons/0/0f/Scandinavian_interior_design.jpg" ],
    service:[ "https://upload.wikimedia.org/wikipedia/commons/6/6f/Electrician_at_work.jpg" ],
    job:[ "https://upload.wikimedia.org/wikipedia/commons/9/9a/Courier_on_bicycle.jpg" ]
  };

  /* ===== Helpers ===== */
  const getDB=()=>{try{return JSON.parse(localStorage.getItem(DB_KEY)||"[]")}catch{return[]}};
  const setDB=v=>localStorage.setItem(DB_KEY,JSON.stringify(v));
  const getCtrl=()=>{try{return JSON.parse(localStorage.getItem(CTRL_KEY)||"{}")}catch{return{}}};
  const setCtrl=v=>localStorage.setItem(CTRL_KEY,JSON.stringify(v));
  const uid=()=>Math.random().toString(16).slice(2)+Date.now().toString(16);
  const rand=(a,b)=>Math.floor(Math.random()*(b-a+1))+a;
  const pick=a=>a[Math.floor(Math.random()*a.length)];
  const round100 = v => Math.max(0, Math.round(v/100)*100);
  function fmtUA(date){ return new Date(date).toLocaleDateString('uk-UA'); }
  function lockScroll(on){ document.body.classList.toggle('modal-open', !!on); }

  function createImg(src, alt, fallback){
    const img=document.createElement("img"); img.loading="lazy"; img.alt=alt; img.referrerPolicy="no-referrer";
    img.src = src || fallback; img.onerror=()=>{ img.onerror=null; img.src=fallback; }; return img;
  }
  function itemPNG(title, seed=0){
    const c=document.createElement('canvas'); c.width=800; c.height=500; const g=c.getContext('2d');
    const palettes=[["#e9f7f1","#cdeee1","#a0dcc8"],["#fff2cf","#ffe6b3","#ffd289"],["#fbe3ea","#ffd6e0","#ffcad6"],["#e6f1ff","#cfe2ff","#b7d4ff"]];
    const pal=palettes[seed%palettes.length]; const grad=g.createLinearGradient(0,0,800,500);
    grad.addColorStop(0,pal[0]); grad.addColorStop(1,pal[1]); g.fillStyle=grad; g.fillRect(0,0,800,500);
    g.fillStyle=pal[2]; g.fillRect(0,420,800,80);
    g.fillStyle='#0f172a'; g.font="bold 42px 'Russo One', Arial"; g.textAlign="center"; g.fillText(title.slice(0,22), 400, 100);
    g.fillStyle="#00000022"; for(let i=0;i<6;i++){ g.fillRect(120+i*90,220+Math.sin(i+seed)*20,60,120); }
    return c.toDataURL('image/png');
  }

  /* ===== Побудова списків ===== */
  const fltCity=$("#fltCity"), fltCat=$("#fltCat"), fltCond=$("#fltCond"),
        fltSeller=$("#fltSeller"), fltPriceMin=$("#fltPriceMin"), fltPriceMax=$("#fltPriceMax"),
        fltQuery=$("#fltQuery"), fltRecent=$("#fltRecent");

  function fillSelect(el, arr, withAll=true, txt="Будь-що"){
    el.innerHTML=(withAll?`<option value="">${txt}</option>`:'')+arr.map(x=>`<option value="${x}">${x}</option>`).join('');
  }
  function buildCityDatalist(list){
    const dl=$("#cityList");
    dl.innerHTML = (list||PLACES).map(p => `<option value="${p.region} • ${p.name}">`).join('');
  }
  buildCityDatalist(); // fallback
  // Ліниве завантаження повного списку (якщо файл існує поруч)
  fetch('ua-places.min.json').then(r=>r.ok?r.json():Promise.reject())
    .then(arr=>{ if(Array.isArray(arr)&&arr.length>1000){ PLACES=arr; buildCityDatalist(arr);} })
    .catch(()=>{}); // тихий fallback

  fillSelect(fltCat, ALL_CATS);
  fillSelect(fltCond, CONDS);
  fillSelect(fltSeller, SELLERS);

  /* ===== Nice Select ===== */
  let activeList=null, activeWrap=null;
  function closeAll(e){
    if(activeList){
      if(e && (activeList.contains(e.target) || activeWrap.contains(e.target))) return;
      activeList.style.display='none'; activeWrap.appendChild(activeList); activeList=null; activeWrap=null;
    }
  }
  document.addEventListener('click', closeAll);
  document.addEventListener('keydown', (e)=>{ 
    if(e.key==='Escape') { 
      closeAll(); 
      $("#detail").classList.remove('active'); lockScroll(false);
      $("#sellOverlay").classList.remove('on'); $("#searchOverlay").classList.remove('on'); 
    } 
  });
  function enhanceSelect(sel){
    if (matchMedia('(hover: none)').matches) return;
    const wrap=document.createElement('div'); wrap.className='nice';
    const btn=document.createElement('button'); btn.type='button'; btn.className='nice-btn';
    const list=document.createElement('div'); list.className='nice-list';
    const opts=[...sel.options];
    function refreshBtn(){ btn.textContent = opts[sel.selectedIndex]?.text || (sel.getAttribute('data-placeholder')||'Виберіть'); }
    function rebuild(){
      list.innerHTML="";
      [...sel.options].forEach((o, idx)=>{
        const it=document.createElement('div'); it.className='nice-item'+(o.selected?' active':''); it.textContent=o.text;
        it.onclick=(ev)=>{ ev.stopPropagation(); sel.selectedIndex=idx; refreshBtn(); [...list.children].forEach(c=>c.classList.remove('active')); it.classList.add('active'); closeAll(); sel.dispatchEvent(new Event('change')); };
        list.appendChild(it);
      });
    }
    rebuild();
    sel.classList.add('nice-hidden'); sel.parentNode.insertBefore(wrap, sel); wrap.appendChild(sel); wrap.appendChild(btn); refreshBtn();
    function open(){ closeAll(); const r=btn.getBoundingClientRect(); list.style.left = r.left+'px'; list.style.top = (r.bottom+6)+'px'; list.style.width = r.width+'px'; list.style.display='block'; document.body.appendChild(list); activeList=list; activeWrap=wrap; }
    btn.onclick=(e)=>{ e.stopPropagation(); if(activeList===list){ closeAll(); } else { rebuild(); open(); } };
  }
  $$('.select').forEach(enhanceSelect);

  /* ===== Генерація 1000 оголошень (без підкатегорій) ===== */
  const FIRSTNAMES=["Олег","Ірина","Сергій","Анна","Віктор","Максим","Марія","Юрій","Олексій","Наталія","Дмитро","Олена","Микита","Андрій","Світлана"];
  const LASTNAMES=["Шевченко","Коваленко","Бондаренко","Ткаченко","Кравченко","Мельник","Ковальчук","Петренко","Поліщук","Гриценко","Савченко","Гнатюк","Яковенко"];
  const OPERATORS=["50","63","66","67","68","73","93","95","96","97","98","99"];
  function genPhone(){ const op=pick(OPERATORS); return `+380 (${op}) ${rand(100,999)}-${rand(10,99)}-${rand(10,99)}`; }

  function imgPool(cat){
    if(cat==="Транспорт") return IMG.car;
    if(cat==="Велосипеди") return IMG.bike;
    if(cat==="Електроніка") return [...IMG.phone, ...IMG.laptop, ...IMG.tv];
    if(cat==="Побутова техніка") return [...IMG.washer];
    if(cat==="Меблі"||cat==="Дім і сад") return [...IMG.sofa, ...IMG.tools, ...IMG.decor];
    if(cat==="Тварини"||cat==="Собаки") return IMG.dog;
    if(cat==="Коти") return IMG.cat;
    if(cat==="Нерухомість") return IMG.flat;
    if(cat==="Послуги") return IMG.service;
    if(cat==="Робота") return IMG.job;
    return [...IMG.phone, ...IMG.tools, ...IMG.sofa];
  }
  function imgSetBy(cat, n=3){
    const pool = imgPool(cat);
    const out = [];
    for(let i=0;i<n;i++) out.push(pool[(i+rand(0,pool.length-1))%pool.length]);
    return out;
  }

  function seedDB(){
    const out=[];
    const TEMPL = {
      "Транспорт":[ "Skoda Octavia 1.6 TDI, {y} • чесний пробіг","Toyota Camry 2.5, {y} • 1 власник","BMW 320d {y} • сервісна історія","Audi A4 2.0 TDI {y} • ідеал","Volkswagen Golf 1.6 {y} • економний" ],
      "Електроніка":[ "iPhone 13 128GB • стан 9/10", "Samsung S21 256GB • офіційний", "Pixel 6 128GB • з чеком","MacBook Pro 16 {y} • i9/16/512" ],
      "Нерухомість":[ "1к центр, {m} м² • новобудова","2к біля метро, {m} м²" ],
      "Меблі":[ "Диван розкладний • як новий","Стіл обідній з дерева" ],
      "Побутова техніка":[ "Пральна машина Bosch • як нова","Холодильник Samsung • NoFrost" ],
      "Велосипеди":[ "Шосейний велосипед • алюміній","MTB з амортизацією" ],
      "Тварини":[ "Щеня голден ретрівер • прививки","Лабрадор дорослий • добрий" ],
      "Коти":[ "Кошеня британське • документи","Мейн-кун дорослий" ],
      "Послуги":[ "Ремонт техніки — виїзд","Майстер на годину" ],
      "Робота":[ "Кур'єр по місту — щоденні виплати","Менеджер з продажів — ставка + %","Бариста — зміни 2/2" ],
      "Дім і сад":[ "Набір інструментів • як новий","Декор сканди" ]
    };

    while(out.length<1000){
      const plc = PLACES[out.length % PLACES.length] || {region:"",name:""};
      const cat = pick(ALL_CATS);
      const cond = pick(CONDS);
      const seller = pick(SELLERS);
      const base =
        (cat==="Нерухомість") ? rand(12000,180000) :
        (cat==="Транспорт") ? rand(20000,1200000) :
        (cat==="Електроніка"||cat==="Побутова техніка") ? rand(1200,80000) :
        (cat==="Послуги" || cat==="Робота") ? rand(200,30000) :
        rand(300,40000);
      const price = round100(base);
      const year = rand(2006, 2025);
      const sM = rand(25, 120);

      const tmpl = TEMPL[cat] && pick(TEMPL[cat]);
      const title = (tmpl||`${cat} — пропозиція`).replace("{y}", year).replace("{m}", sM);

      const created = Date.now() - rand(0, 60*86400*1000);
      const views = round100(rand(50, 5000));
      const likes = Math.min(999, Math.round(views/25)+rand(0,10));
      const images = imgSetBy(cat, 3);
      const name = `${pick(FIRSTNAMES)} ${pick(LASTNAMES)}`;
      const descPool = [
        "Стан відмінний, уважно доглянуте. Перевірка в сервісі вітається. Можлива доставка/самовивіз.",
        "Реальне оголошення — фото відповідають дійсності. Причина продажу: оновлення/переїзд.",
        "Комплектація на фото. Без прихованих дефектів. Торг біля капота/при зустрічі.",
        "Відправлю Новою поштою або зустріч у центрі. Пишіть у будь-який час у месенджер."
      ];

      out.push({
        id: uid(),
        region: plc.region,
        city: plc.name,
        cat,
        title,
        price, currency:"₴",
        cond, seller,
        created, views, likes,
        desc: pick(descPool),
        images,
        contact: {name, phone: genPhone()}
      });
    }
    setDB(out);
  }

  /* ===== HOT ===== */
  function ensureHot(){
    const ctrl = getCtrl();
    const db = getDB();
    const now = Date.now();
    if(!ctrl.hotUntil || !ctrl.hotIds || now > ctrl.hotUntil || !Array.isArray(ctrl.hotIds)){
      const scored = db.map(x => ({
        id: x.id,
        score: (x.likes||0)*6 + (x.views||0) + Math.max(0, 5000 - (now - x.created)/1000)
      })).sort((a,b)=>b.score-a.score);
      ctrl.hotIds = scored.slice(0,10).map(s=>s.id);
      ctrl.hotUntil = now + 7*24*3600*1000;
      setCtrl(ctrl);
    }
    renderHot(ctrl.hotIds);
  }
  function renderHot(ids){
    const grid=$("#hotGrid"); grid.innerHTML="";
    const db = getDB();
    const items = ids.map(id => db.find(x=>x.id===id)).filter(Boolean);
    if(items.length){
      $("#hotPanel").style.display="block";
      $("#hotSplit").style.display="block";
      items.forEach(it=>{
        const card=document.createElement('div'); card.className='hotCard'; card.onclick=()=>openDetail(it.id);
        const fallback=itemPNG(it.title,(it.price+it.created)%7);
        card.innerHTML=`
          <div class="thumb"></div>
          <div class="hotBadge">HOT</div>
          <div class="hotPrice">${it.price.toLocaleString('uk-UA')} ${it.currency}</div>
          <div class="hotBody">
            <div class="hotTTL">${it.title}</div>
            <div style="opacity:.85">${it.city} • ${it.cat}</div>
            <div style="opacity:.85">♥ ${it.likes||0} • 👁 ${it.views||0}</div>
          </div>`;
        card.querySelector('.thumb').appendChild(createImg((it.images&&it.images[0])||"", it.title, fallback));
        grid.appendChild(card);
      });
    } else {
      $("#hotPanel").style.display="none";
      $("#hotSplit").style.display="none";
    }
  }

  /* ===== Додавання ===== */
  function initSellForm(){
    $("#sCat").innerHTML=ALL_CATS.map(x=>`<option value="${x}">${x}</option>`).join('');
    $("#sCond").innerHTML=CONDS.map(x=>`<option value="${x}">${x}</option>`).join('');
    $("#sSeller").innerHTML=SELLERS.map(x=>`<option value="${x}">${x}</option>`).join('');
  }
  initSellForm();

  $("#sSave").onclick=()=>{
    const ctrl=getCtrl(); const now=Date.now();
    if(ctrl.lastPost && now-ctrl.lastPost<60000){ alert("Публікувати можна не частіше 1 разу на 60 сек."); return; }
    const city=$("#sCity").value.trim(), cat=$("#sCat").value, title=$("#sTitle").value.trim();
    if(!city||!cat||!title) return alert("Заповніть місто/категорію/заголовок.");
    const priceRaw=+(($("#sPrice").value||0)); if(!(priceRaw>=0 && priceRaw<=100000000)) return alert("Перевірте ціну.");
    const price = round100(priceRaw);
    const phone=$("#sPhone").value.trim(); if(phone && !/^\+?\d[\d\s\-\(\)]{8,}$/.test(phone)) return alert("Телефон некоректний.");
    const desc=$("#sDesc").value.trim(); if(desc.length<20) return alert("Опис ≥ 20 символів.");
    const cond=$("#sCond").value, seller=$("#sSeller").value;
    const imgs=($("#sImages").value||"").split("|").map(x=>x.trim()).filter(Boolean);
    const db=getDB();
    const [maybeRegion, maybePlace] = city.includes("•") ? city.split("•").map(s=>s.trim()) : ["", city];
    db.unshift({
      id: uid(), region: maybeRegion || (PLACES.find(p=>p.name===maybePlace)?.region || ""), city: maybePlace,
      cat, title, price, currency:"₴", cond, seller, created:now, views: rand(120,480), likes:0,
      desc, images: imgs.length? imgs : imgSetBy(cat, 3),
      contact:{name:"Продавець", phone: phone||genPhone()}
    });
    setDB(db); ctrl.lastPost=now; setCtrl(ctrl);
    alert("Оголошення опубліковано.");
    $("#sTitle").value=""; $("#sPrice").value=""; $("#sPhone").value=""; $("#sDesc").value=""; $("#sImages").value=""; $("#sCity").value="";
    $("#sellOverlay").classList.remove('on'); lockScroll(false); applyFilters(); ensureHot();
  };

  /* ===== Пошук/рендер ===== */
  const grid=$("#grid"), btnMore=$("#btnMore"), sortBy=$("#sortBy");
  let page=0, pageSize=24, lastResults=[];

  function parseCityInput(val){
    val=(val||"").trim();
    if(!val) return {region:"", city:""};
    if(val.includes("•")){
      const [region,city] = val.split("•").map(x=>x.trim());
      return {region, city};
    }
    // якщо просто назва — шукаємо у PLACES
    const hit = PLACES.find(p=>p.name.toLowerCase()===val.toLowerCase());
    return hit? {region:hit.region, city:hit.name} : {region:"", city:val};
  }

  function applyFilters(){
    const q=(fltQuery.value||"").trim().toLowerCase();
    const pmin= +(fltPriceMin.value||0);
    const pmax= +(fltPriceMax.value||0);
    const place = parseCityInput(fltCity.value);

    let arr=getDB().filter(it=>
      (!place.region || it.region===place.region) &&
      (!place.city || it.city===place.city) &&
      (!fltCat.value || it.cat===fltCat.value) &&
      (!fltCond.value || it.cond===fltCond.value) &&
      (!fltSeller.value || it.seller===fltSeller.value) &&
      (!pmin || it.price>=pmin) &&
      (!pmax || it.price<=pmax) &&
      (!q || (it.title+' '+it.cat).toLowerCase().includes(q)) &&
      (!fltRecent.checked || (Date.now()-it.created)<=30*86400*1000)
    );

    arr.sort((a,b)=>{
      switch(sortBy.value){
        case "priceAsc": return a.price-b.price;
        case "priceDesc": return b.price-a.price;
        case "likesDesc": return (b.likes||0)-(a.likes||0);
        case "viewsDesc": return (b.views||0)-(a.views||0);
        default: return b.created-a.created;
      }
    });

    lastResults=arr; page=0; grid.innerHTML="";
    renderMore();
  }
  function remainingCount(){ return Math.max(0, lastResults.length - page*pageSize); }
  function updateMoreUI(){ btnMore.style.display = remainingCount()>0 ? "inline-flex" : "none"; }
  function renderMore(){ const slice=lastResults.slice(page*pageSize,(page+1)*pageSize); slice.forEach(renderCard); page++; updateMoreUI(); }

  function like(id){
    const db=getDB(); const idx=db.findIndex(x=>x.id===id); if(idx<0) return false;
    const ctrl=getCtrl(); ctrl.liked = ctrl.liked||{};
    if(ctrl.liked[id]){ return false; }
    db[idx].likes = (db[idx].likes||0) + 1;
    setDB(db); ctrl.liked[id]=true; setCtrl(ctrl);
    return true;
  }

  function renderCard(it){
    const el=document.createElement('article'); el.className="card"; el.setAttribute('role','button'); el.title="Дивитися";
    const fallback=itemPNG(it.title, (it.price+it.created)%7);
    const firstImg=(Array.isArray(it.images)&&it.images.length)?it.images[0]:null;
    el.innerHTML=`
      <div class="thumb">
        <button class="likeBtn" title="Лайк">♥ <span>${it.likes||0}</span></button>
        <div class="badge">${it.price.toLocaleString('uk-UA')} ${it.currency||"₴"}</div>
        <div class="views">👁 ${it.views||0}</div>
      </div>
      <div class="body">
        <div class="title">${it.title}</div>
        <div class="meta" style="color:var(--muted)">${it.cat}</div>
        <div class="meta" style="color:var(--muted)">${it.region} • ${it.city}</div>
      </div>`;
    const likeButton = el.querySelector(".likeBtn");
    // не даємо фокусу, щоб не було стрибка
    likeButton.addEventListener('mousedown', e=>e.preventDefault());
    likeButton.onclick=(e)=>{
      e.stopPropagation();
      if(like(it.id)){ 
        it.likes=(it.likes||0)+1; 
        likeButton.querySelector("span").textContent = it.likes;
        ensureHot();
      }
    };
    el.querySelector(".thumb").prepend(createImg(firstImg, it.title, fallback));
    el.onclick=()=>openDetail(it.id);
    grid.appendChild(el);
  }

  const dLikeBtn = $("#dLike"), dLikeCnt = $("#dLikeCnt");
  let galIndex=0, galImgs=[], currentId=null, currentItem=null;

  function renderGallery(title){
    const gal=$("#dGal");
    gal.innerHTML=`<div class="big"><button class="navBtn navPrev" id="galPrev" aria-label="Попереднє">‹</button><button class="navBtn navNext" id="galNext" aria-label="Наступне">›</button></div>`;
    const big=gal.querySelector('.big'); const url=galImgs[galIndex];
    big.appendChild(createImg(url, 'photo', itemPNG(title,galIndex)));
    $("#galPrev").onclick=()=>{ galIndex=(galIndex-1+galImgs.length)%galImgs.length; renderGallery(title); };
    $("#galNext").onclick=()=>{ galIndex=(galIndex+1)%galImgs.length; renderGallery(title); };
  }

  function openDetail(id){
    const db=getDB(); const idx=db.findIndex(x=>x.id===id); if(idx<0) return;
    currentId=id; currentItem=db[idx];
    currentItem.views=(currentItem.views||0)+1; db[idx]=currentItem; setDB(db);

    const d=$("#detail"); d.classList.add('active'); d.setAttribute('aria-hidden','false'); lockScroll(true);
    $("#dClose").onclick=()=>{ d.classList.remove('active'); d.setAttribute('aria-hidden','true'); lockScroll(false); applyFilters(); ensureHot(); };

    $("#dHeader").innerHTML=`
      <div class="title" style="font:700 20px/1.2 'Russo One'; color:#0f172a">${currentItem.title}</div>
      <div class="pill green" style="height:38px;line-height:38px;border-radius:12px">₴ ${currentItem.price.toLocaleString('uk-UA')}</div>
      <div class="pill" style="margin-left:auto">👁 ${currentItem.views}</div>`;
    const imgs=(Array.isArray(currentItem.images)&&currentItem.images.length)?currentItem.images:[itemPNG(currentItem.title,0),itemPNG(currentItem.title,1),itemPNG(currentItem.title,2)];
    galImgs = imgs; galIndex=0; renderGallery(currentItem.title);

    $("#dSpecs").innerHTML=
      `<div class="spec"><div class="h">Категорія</div>${currentItem.cat}</div>`+
      `<div class="spec"><div class="h">Область</div>${currentItem.region}</div>`+
      `<div class="spec"><div class="h">Місто/Село</div>${currentItem.city}</div>`+
      `<div class="spec"><div class="h">Стан</div>${currentItem.cond}</div>`+
      `<div class="spec"><div class="h">Тип продавця</div>${currentItem.seller}</div>`+
      `<div class="spec"><div class="h">Опубліковано</div>${fmtUA(currentItem.created)}</div>`;

    $("#dDesc").textContent = currentItem.desc||"";
    const initials=(currentItem.contact?.name||"П")[0];
    $("#dSeller").innerHTML=`<div class="avatar">${initials}</div><div><div class="h">Продавець</div><div>${currentItem.contact?.name||"Продавець"}</div><div style="opacity:.85">${currentItem.contact?.phone||"—"}</div></div>`;

    dLikeCnt.textContent = currentItem.likes||0;
    dLikeBtn.onclick=()=>{
      if(like(currentId)){
        currentItem.likes=(currentItem.likes||0)+1;
        dLikeCnt.textContent = currentItem.likes;
        applyFilters(); ensureHot();
      }
    };
  }

  /* ===== Перший старт ===== */
  (function init(){
    // 5 секунд прелоадер
    lockScroll(true);
    setTimeout(()=>{ const pl=$("#preloader"); pl.style.display='none'; lockScroll(false); }, 5000);

    if(getDB().length===0){ seedDB(); }
    applyFilters();
    ensureHot();
  })();

  /* Вкладки + модалі + блокування скролу */
  $("#tabSearch").onclick=()=>{ $("#searchOverlay").classList.add('on'); $("#searchOverlay").setAttribute('aria-hidden','false'); lockScroll(true); };
  $("#searchClose").onclick=()=>{ $("#searchOverlay").classList.remove('on'); $("#searchOverlay").setAttribute('aria-hidden','true'); lockScroll(false); };
  $("#tabSell").onclick=()=>{ $("#sellOverlay").classList.add('on'); $("#sellOverlay").setAttribute('aria-hidden','false'); lockScroll(true); };
  $("#sellClose").onclick=()=>{ $("#sellOverlay").classList.remove('on'); $("#sellOverlay").setAttribute('aria-hidden','true'); lockScroll(false); };

  /* Кнопки пошуку */
  let applyLock=false;
  $("#btnApply").onclick=()=>{ if(applyLock) return; applyLock=true; applyFilters(); $("#searchOverlay").classList.remove('on'); lockScroll(false); setTimeout(()=>applyLock=false, 300); };
  $("#btnReset").onclick=()=>{ $$("#searchOverlay .select, #searchOverlay .input").forEach(x=>x.value=""); fltRecent.checked=false; applyFilters(); };

  btnMore.onclick=renderMore; sortBy.onchange=applyFilters;
  </script>
</body>
</html>
